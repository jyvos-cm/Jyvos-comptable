<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JYVOS Admin ‚Äî Tableau de bord Super Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
:root{
  --bg:#f0f2f5;
  --surface:#ffffff;
  --surface2:#f8f9fb;
  --border:#e4e8ef;
  --border2:#edf0f5;
  --text:#0f1c2e;
  --text2:#4a5568;
  --muted:#8fa0b4;
  --green:#00a86b;--green-bg:#f0fdf6;--green-border:#c3f0db;
  --red:#e53e3e;--red-bg:#fff5f5;--red-border:#fed7d7;
  --amber:#d97706;--amber-bg:#fffbeb;--amber-border:#fde68a;
  --blue:#2563eb;--blue-bg:#eff6ff;--blue-border:#bfdbfe;
  --purple:#7c3aed;--purple-bg:#f5f3ff;--purple-border:#ddd6fe;
  --shadow-sm:0 1px 3px rgba(0,0,0,0.06),0 1px 2px rgba(0,0,0,0.04);
  --shadow:0 4px 16px rgba(0,0,0,0.07),0 1px 4px rgba(0,0,0,0.04);
  --shadow-lg:0 10px 40px rgba(0,0,0,0.1),0 2px 8px rgba(0,0,0,0.05);
  --radius:12px;--radius-sm:8px;--radius-lg:16px;
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;overflow:hidden;}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column;font-size:14px;}

/* ‚îÄ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ‚îÄ */
.topbar{
  height:58px;background:var(--surface);border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 28px;flex-shrink:0;
  box-shadow:0 1px 0 var(--border2);
  z-index:100;position:relative;
}
.topbar-brand{display:flex;align-items:center;gap:12px;}
.brand-logo{
  width:34px;height:34px;border-radius:9px;
  background:linear-gradient(135deg,#00a86b,#0077cc);
  display:flex;align-items:center;justify-content:center;
  font-weight:800;font-size:16px;color:#fff;
  box-shadow:0 2px 8px rgba(0,168,107,0.3);
}
.brand-name{font-weight:800;font-size:17px;letter-spacing:-0.3px;color:var(--text);}
.brand-name span{color:var(--green);}
.brand-tag{font-size:11px;font-weight:600;color:var(--muted);letter-spacing:0.5px;margin-top:1px;}
.topbar-center{display:flex;align-items:center;gap:6px;background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:7px 14px;min-width:260px;}
.topbar-center input{background:none;border:none;outline:none;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--text);width:100%;}
.topbar-center input::placeholder{color:var(--muted);}
.topbar-right{display:flex;align-items:center;gap:10px;}
.live-pill{display:flex;align-items:center;gap:6px;background:var(--green-bg);border:1px solid var(--green-border);border-radius:20px;padding:5px 12px;font-size:11px;font-weight:700;color:var(--green);letter-spacing:0.5px;}
.live-dot{width:6px;height:6px;border-radius:50%;background:var(--green);animation:pulse 1.5s ease infinite;}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(0,168,107,0.4);}50%{box-shadow:0 0 0 4px rgba(0,168,107,0);}}
.icon-btn{width:36px;height:36px;border-radius:8px;border:1px solid var(--border);background:var(--surface);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:15px;color:var(--text2);position:relative;transition:all 0.15s;}
.icon-btn:hover{background:var(--bg);border-color:var(--border);}
.icon-btn .badge{position:absolute;top:-4px;right:-4px;width:16px;height:16px;border-radius:50%;background:var(--red);color:#fff;font-size:9px;font-weight:700;display:flex;align-items:center;justify-content:center;border:2px solid var(--surface);}
.admin-pill{display:flex;align-items:center;gap:8px;padding:5px 12px 5px 6px;border:1px solid var(--border);border-radius:20px;background:var(--surface);cursor:pointer;}
.admin-av{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,#7c3aed,#2563eb);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff;}
.admin-name{font-size:12px;font-weight:600;color:var(--text);}
.topbar-clock{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--muted);font-weight:600;min-width:68px;text-align:right;}

/* ‚îÄ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ */
.layout{display:grid;grid-template-columns:220px 1fr;flex:1;overflow:hidden;}

/* ‚îÄ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ‚îÄ */
.sidebar{background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow-y:auto;padding:20px 0;}
.nav-group{margin-bottom:4px;}
.nav-label{font-size:10px;font-weight:700;color:var(--muted);letter-spacing:1px;text-transform:uppercase;padding:8px 20px 4px;}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 20px;cursor:pointer;font-size:13px;font-weight:500;color:var(--text2);border-radius:0;transition:all 0.15s;position:relative;}
.nav-item:hover{background:var(--bg);color:var(--text);}
.nav-item.active{background:var(--green-bg);color:var(--green);font-weight:600;}
.nav-item.active::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--green);border-radius:0 3px 3px 0;}
.nav-item .ni{font-size:15px;width:18px;text-align:center;flex-shrink:0;}
.nav-chip{margin-left:auto;font-size:10px;font-weight:700;padding:2px 7px;border-radius:20px;}
.chip-red{background:var(--red-bg);color:var(--red);border:1px solid var(--red-border);}
.chip-green{background:var(--green-bg);color:var(--green);border:1px solid var(--green-border);}
.chip-blue{background:var(--blue-bg);color:var(--blue);border:1px solid var(--blue-border);}
.sidebar-user{margin:auto 12px 0;background:var(--bg);border-radius:var(--radius-sm);padding:12px;border:1px solid var(--border2);}
.su-top{display:flex;align-items:center;gap:8px;margin-bottom:10px;}
.su-av{width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,#00a86b,#0077cc);display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:#fff;flex-shrink:0;}
.su-name{font-size:12px;font-weight:600;}
.su-role{font-size:10px;color:var(--green);font-weight:600;}
.su-stat{font-size:11px;color:var(--muted);display:flex;align-items:center;justify-content:space-between;}
.su-stat-val{font-weight:700;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px;}

/* ‚îÄ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ‚îÄ */
.main{overflow-y:auto;display:flex;flex-direction:column;}
.page{display:none;padding:24px 28px;flex-direction:column;gap:20px;}
.page.active{display:flex;}
.page-hdr{display:flex;align-items:flex-start;justify-content:space-between;}
.page-title{font-size:20px;font-weight:800;letter-spacing:-0.4px;color:var(--text);}
.page-sub{font-size:13px;color:var(--muted);margin-top:2px;font-weight:400;}
.hdr-actions{display:flex;gap:8px;align-items:center;}
.btn{padding:8px 16px;border-radius:8px;font-size:13px;font-weight:600;font-family:'Plus Jakarta Sans',sans-serif;cursor:pointer;border:none;transition:all 0.15s;display:flex;align-items:center;gap:6px;}
.btn-primary{background:var(--green);color:#fff;box-shadow:0 2px 8px rgba(0,168,107,0.25);}
.btn-primary:hover{background:#00956b;transform:translateY(-1px);}
.btn-outline{background:var(--surface);border:1px solid var(--border);color:var(--text2);}
.btn-outline:hover{background:var(--bg);color:var(--text);}
.btn-xs{padding:5px 10px;font-size:11px;border-radius:6px;}

/* ‚îÄ‚îÄ‚îÄ REVENUE HERO ‚îÄ‚îÄ‚îÄ */
.rev-hero{
  background:linear-gradient(135deg,#0f1c2e 0%,#1a3358 50%,#0d2040 100%);
  border-radius:var(--radius-lg);padding:28px 32px;
  display:grid;grid-template-columns:1fr auto;align-items:center;gap:24px;
  box-shadow:var(--shadow-lg);
  position:relative;overflow:hidden;
}
.rev-hero::before{
  content:'';position:absolute;right:-80px;top:-80px;
  width:280px;height:280px;border-radius:50%;
  background:radial-gradient(circle,rgba(0,168,107,0.15),transparent 70%);
}
.rev-hero::after{
  content:'';position:absolute;left:40%;bottom:-60px;
  width:200px;height:200px;border-radius:50%;
  background:radial-gradient(circle,rgba(0,119,204,0.1),transparent 70%);
}
.rh-label{font-size:11px;font-weight:700;color:rgba(255,255,255,0.5);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:8px;display:flex;align-items:center;gap:6px;}
.rh-label::before{content:'';width:16px;height:2px;background:#00a86b;border-radius:1px;}
.rh-amount{font-family:'JetBrains Mono',monospace;font-size:44px;font-weight:700;color:#fff;letter-spacing:-1px;line-height:1;}
.rh-amount .currency{font-size:20px;color:rgba(255,255,255,0.6);font-weight:400;margin-left:4px;}
.rh-change{margin-top:8px;display:flex;align-items:center;gap:6px;}
.change-badge{display:flex;align-items:center;gap:3px;background:rgba(0,168,107,0.2);color:#4ade80;font-size:12px;font-weight:700;padding:3px 9px;border-radius:20px;}
.rh-change-sub{font-size:12px;color:rgba(255,255,255,0.45);}
.rh-stats{display:flex;gap:24px;position:relative;z-index:1;}
.rh-stat{text-align:center;padding:16px 20px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.09);border-radius:10px;min-width:100px;}
.rh-stat-val{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700;color:#fff;line-height:1;}
.rh-stat-lbl{font-size:10px;color:rgba(255,255,255,0.45);text-transform:uppercase;letter-spacing:1px;margin-top:5px;font-weight:600;}
.rh-stat-trend{font-size:11px;margin-top:4px;color:#4ade80;font-weight:600;}

/* ‚îÄ‚îÄ‚îÄ KPI GRID ‚îÄ‚îÄ‚îÄ */
.kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;}
.kpi-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px 20px;box-shadow:var(--shadow-sm);transition:all 0.2s;position:relative;overflow:hidden;}
.kpi-card:hover{box-shadow:var(--shadow);transform:translateY(-2px);}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--kc,var(--green));opacity:0.7;}
.kpi-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;}
.kpi-icon{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:17px;background:var(--ki-bg,var(--green-bg));}
.kpi-menu{font-size:16px;color:var(--muted);cursor:pointer;}
.kpi-val{font-family:'JetBrains Mono',monospace;font-size:26px;font-weight:700;color:var(--text);letter-spacing:-0.5px;line-height:1;margin-bottom:6px;}
.kpi-lbl{font-size:11px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px;}
.kpi-footer{display:flex;align-items:center;justify-content:space-between;}
.kpi-trend{font-size:12px;font-weight:600;display:flex;align-items:center;gap:4px;}
.trend-up{color:var(--green);}
.trend-down{color:var(--red);}
.trend-neu{color:var(--muted);}
.kpi-sparkline{height:32px;width:80px;}

/* ‚îÄ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ‚îÄ */
.sec-hdr{display:flex;align-items:center;justify-content:space-between;}
.sec-title{font-size:15px;font-weight:700;color:var(--text);display:flex;align-items:center;gap:8px;}
.sec-title::before{content:'';width:3px;height:16px;background:var(--green);border-radius:2px;flex-shrink:0;}
.sec-actions{display:flex;gap:8px;align-items:center;}

/* ‚îÄ‚îÄ‚îÄ CHARTS ROW ‚îÄ‚îÄ‚îÄ */
.charts-row{display:grid;grid-template-columns:1.7fr 1fr 1fr;gap:14px;}
.chart-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow-sm);}
.chart-hdr{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:16px;}
.chart-title{font-size:13px;font-weight:700;color:var(--text);}
.chart-sub{font-size:11px;color:var(--muted);margin-top:2px;}
.chart-badge{font-size:10px;font-weight:700;padding:3px 8px;border-radius:20px;letter-spacing:0.3px;border:1px solid;}
.cb-green{background:var(--green-bg);color:var(--green);border-color:var(--green-border);}
.cb-blue{background:var(--blue-bg);color:var(--blue);border-color:var(--blue-border);}
.cb-amber{background:var(--amber-bg);color:var(--amber);border-color:var(--amber-border);}
canvas{max-height:140px;}
.legend-row{display:flex;flex-direction:column;gap:7px;margin-top:12px;}
.leg-item{display:flex;align-items:center;justify-content:space-between;font-size:12px;}
.leg-left{display:flex;align-items:center;gap:7px;color:var(--text2);}
.leg-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.leg-val{font-weight:700;font-family:'JetBrains Mono',monospace;color:var(--text);}

/* ‚îÄ‚îÄ‚îÄ USER TABLE ‚îÄ‚îÄ‚îÄ */
.table-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow-sm);overflow:hidden;}
.table-toolbar{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--border2);}
.search-wrap{display:flex;align-items:center;gap:8px;background:var(--bg);border:1px solid var(--border);border-radius:7px;padding:7px 12px;transition:border-color 0.15s;}
.search-wrap:focus-within{border-color:#93c5fd;}
.search-wrap input{background:none;border:none;outline:none;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;color:var(--text);width:180px;}
.search-wrap input::placeholder{color:var(--muted);}
.filter-group{display:flex;background:var(--bg);border:1px solid var(--border);border-radius:7px;overflow:hidden;}
.f-tab{padding:6px 14px;font-size:12px;font-weight:600;font-family:'Plus Jakarta Sans',sans-serif;border:none;background:none;color:var(--muted);cursor:pointer;transition:all 0.15s;}
.f-tab.active{background:var(--surface);color:var(--text);box-shadow:var(--shadow-sm);}
.utbl{width:100%;border-collapse:collapse;}
.utbl th{text-align:left;font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:0.6px;padding:11px 20px;background:var(--surface2);border-bottom:1px solid var(--border);}
.utbl td{padding:13px 20px;border-bottom:1px solid var(--border2);font-size:13px;vertical-align:middle;}
.utbl tr:last-child td{border-bottom:none;}
.utbl tr:hover td{background:#fafbfd;}
.u-cell{display:flex;align-items:center;gap:11px;}
.u-av{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;}
.u-name{font-size:13px;font-weight:600;color:var(--text);}
.u-email{font-size:11px;color:var(--muted);}
.money-cell{font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:700;}
.mc-high{color:var(--green);}
.mc-mid{color:var(--amber);}
.mc-low{color:var(--red);}
.tx-num{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:700;color:var(--blue);}
.perf-wrap{display:flex;align-items:center;gap:8px;}
.perf-track{flex:1;height:5px;background:var(--border);border-radius:3px;overflow:hidden;min-width:60px;}
.perf-fill{height:100%;border-radius:3px;transition:width 0.8s ease;}
.perf-pct{font-size:11px;font-weight:700;min-width:28px;text-align:right;}
.status-tag{display:inline-flex;align-items:center;gap:5px;font-size:11px;font-weight:700;padding:4px 10px;border-radius:20px;letter-spacing:0.3px;}
.st-active{background:var(--green-bg);color:var(--green);border:1px solid var(--green-border);}
.st-trial{background:var(--amber-bg);color:var(--amber);border:1px solid var(--amber-border);}
.st-expired{background:var(--red-bg);color:var(--red);border:1px solid var(--red-border);}
.st-dot{width:5px;height:5px;border-radius:50%;background:currentColor;}
.sub-info{font-size:11px;color:var(--muted);}
.stock-mini{display:flex;flex-direction:column;gap:3px;min-width:90px;}
.sm-bar{height:3px;background:var(--border);border-radius:2px;overflow:hidden;}
.sm-fill{height:100%;border-radius:2px;}
.sm-lbl{font-size:10px;color:var(--muted);}
.act-wrap{display:flex;gap:5px;}
.act{width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--text2);transition:all 0.15s;}
.act:hover.view{background:var(--blue-bg);border-color:var(--blue-border);color:var(--blue);}
.act:hover.edit{background:var(--amber-bg);border-color:var(--amber-border);color:var(--amber);}
.act:hover.del{background:var(--red-bg);border-color:var(--red-border);color:var(--red);}
.table-footer{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-top:1px solid var(--border2);background:var(--surface2);}
.tf-info{font-size:12px;color:var(--muted);}
.tf-info strong{color:var(--text);font-weight:700;}

/* ‚îÄ‚îÄ‚îÄ BOTTOM ROW ‚îÄ‚îÄ‚îÄ */
.bottom-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;}
.mini-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow-sm);}
.mc-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;}
.mc-title{font-size:13px;font-weight:700;color:var(--text);}

/* ‚îÄ‚îÄ‚îÄ FEED ‚îÄ‚îÄ‚îÄ */
.feed-list{display:flex;flex-direction:column;gap:8px;max-height:190px;overflow-y:auto;}
.feed-item{display:flex;align-items:flex-start;gap:10px;padding:9px 10px;border-radius:8px;background:var(--surface2);border:1px solid var(--border2);}
.feed-ico{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;}
.feed-body{flex:1;}
.feed-txt{font-size:12px;color:var(--text2);line-height:1.4;}
.feed-txt strong{color:var(--text);font-weight:600;}
.feed-time{font-size:10px;color:var(--muted);margin-top:2px;font-family:'JetBrains Mono',monospace;}
.feed-amount{font-size:12px;font-weight:700;color:var(--green);font-family:'JetBrains Mono',monospace;margin-top:2px;flex-shrink:0;}

/* ‚îÄ‚îÄ‚îÄ TASKS ‚îÄ‚îÄ‚îÄ */
.tasks-list{display:flex;flex-direction:column;gap:7px;}
.task-item{display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:8px;background:var(--surface2);border:1px solid var(--border2);cursor:pointer;transition:all 0.15s;}
.task-item:hover{border-color:var(--green-border);background:var(--green-bg);}
.task-cb{width:18px;height:18px;border-radius:5px;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:10px;flex-shrink:0;transition:all 0.15s;}
.task-item.done .task-cb{background:var(--green);border-color:var(--green);color:#fff;}
.task-lbl{flex:1;font-size:12px;color:var(--text2);}
.task-item.done .task-lbl{text-decoration:line-through;color:var(--muted);}
.task-prio{font-size:9px;font-weight:700;padding:2px 6px;border-radius:4px;}
.tp-h{background:var(--red-bg);color:var(--red);}
.tp-m{background:var(--amber-bg);color:var(--amber);}
.tp-l{background:var(--green-bg);color:var(--green);}

/* ‚îÄ‚îÄ‚îÄ STOCK TABLE ‚îÄ‚îÄ‚îÄ */
.stock-list{display:flex;flex-direction:column;gap:8px;max-height:190px;overflow-y:auto;}
.stock-item{display:flex;align-items:center;gap:10px;padding:9px 10px;border-radius:8px;background:var(--surface2);border:1px solid var(--border2);}
.st-ico{font-size:18px;width:30px;text-align:center;flex-shrink:0;}
.st-info{flex:1;}
.st-name{font-size:12px;font-weight:600;color:var(--text);}
.st-user{font-size:10px;color:var(--muted);}
.st-right{text-align:right;}
.st-qty{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:700;}
.st-bar{width:60px;height:3px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:3px;margin-left:auto;}
.st-bar-fill{height:100%;border-radius:2px;}

/* ‚îÄ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ */
::-webkit-scrollbar{width:4px;height:4px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}
::-webkit-scrollbar-thumb:hover{background:#cbd5e0;}

/* ‚îÄ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ‚îÄ */
@keyframes fadeUp{from{opacity:0;transform:translateY(12px);}to{opacity:1;transform:translateY(0);}}
.kpi-card{animation:fadeUp 0.4s ease both;}
.kpi-card:nth-child(1){animation-delay:0.04s}
.kpi-card:nth-child(2){animation-delay:0.08s}
.kpi-card:nth-child(3){animation-delay:0.12s}
.kpi-card:nth-child(4){animation-delay:0.16s}
.rev-hero,.charts-row,.table-card,.bottom-row{animation:fadeUp 0.45s ease both;}
.charts-row{animation-delay:0.1s}
.table-card{animation-delay:0.15s}
.bottom-row{animation-delay:0.2s}
</style>
</head>
<body>

<!-- ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ -->
<header class="topbar">
  <div class="topbar-brand">
    <div class="brand-logo">J</div>
    <div>
      <div class="brand-name">JYVOS <span>Comptable</span></div>
      <div class="brand-tag">Super Admin Panel</div>
    </div>
  </div>
  <div class="topbar-center">
    <span style="color:var(--muted);font-size:14px">üîç</span>
    <input type="text" placeholder="Rechercher un utilisateur, une transaction‚Ä¶">
  </div>
  <div class="topbar-right">
    <div class="live-pill"><div class="live-dot"></div>LIVE</div>
    <div class="topbar-clock" id="clock">--:--:--</div>
    <div class="icon-btn">üîî<div class="badge">3</div></div>
    <div class="icon-btn">üì•</div>
    <div class="admin-pill">
      <div class="admin-av">AD</div>
      <span class="admin-name">Super Admin</span>
    </div>
  </div>
</header>

<!-- ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ -->
<div class="layout">

  <!-- ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ -->
  <aside class="sidebar">
    <div class="nav-group">
      <div class="nav-label">G√©n√©ral</div>
      <div class="nav-item active" onclick="switchPage('overview',this)"><span class="ni">‚äû</span> Vue d'ensemble</div>
      <div class="nav-item" onclick="switchPage('users',this)"><span class="ni">üë•</span> Utilisateurs <span class="nav-chip chip-blue" id="chip-users">8</span></div>
      <div class="nav-item" onclick="switchPage('revenue',this)"><span class="ni">üí∞</span> Revenus</div>
      <div class="nav-item" onclick="switchPage('stock',this)"><span class="ni">üì¶</span> Stock & Ventes <span class="nav-chip chip-red">!</span></div>
    </div>
    <div class="nav-group">
      <div class="nav-label">Administration</div>
      <div class="nav-item" onclick="switchPage('tasks',this)"><span class="ni">‚úì</span> T√¢ches <span class="nav-chip chip-green">5</span></div>
      <div class="nav-item" onclick="switchPage('overview',this)"><span class="ni">üìä</span> Rapports</div>
      <div class="nav-item" onclick="switchPage('overview',this)"><span class="ni">üîí</span> S√©curit√©</div>
      <div class="nav-item" onclick="switchPage('overview',this)"><span class="ni">‚öô</span> Param√®tres</div>
    </div>
    <div class="sidebar-user">
      <div class="su-top">
        <div class="su-av">AD</div>
        <div>
          <div class="su-name">Super Admin</div>
          <div class="su-role">Acc√®s total</div>
        </div>
      </div>
      <div class="su-stat">
        <span>Revenus totaux</span>
        <span class="su-stat-val" id="sb-total">‚Äî</span>
      </div>
    </div>
  </aside>

  <!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
  <main class="main">

    <!-- ‚ïê‚ïê PAGE OVERVIEW ‚ïê‚ïê -->
    <div class="page active" id="page-overview">

      <!-- Page header -->
      <div class="page-hdr">
        <div>
          <div class="page-title">Tableau de bord</div>
          <div class="page-sub" id="date-sub">Chargement‚Ä¶</div>
        </div>
        <div class="hdr-actions">
          <button class="btn btn-outline" onclick="exportData()">‚¨á Exporter</button>
          <button class="btn btn-primary" onclick="addUser()">Ôºã Nouvel utilisateur</button>
        </div>
      </div>

      <!-- Revenue hero -->
      <div class="rev-hero">
        <div style="position:relative;z-index:1;">
          <div class="rh-label">Argent total g√©n√©r√© par vos utilisateurs</div>
          <div class="rh-amount">
            <span id="hero-amount">0</span>
            <span class="currency">FCFA</span>
          </div>
          <div class="rh-change">
            <div class="change-badge">‚Üë +23%</div>
            <span class="rh-change-sub">vs mois dernier ‚Ä¢ mis √† jour en temps r√©el</span>
          </div>
        </div>
        <div class="rh-stats">
          <div class="rh-stat">
            <div class="rh-stat-val" id="st-users">0</div>
            <div class="rh-stat-lbl">Utilisateurs</div>
            <div class="rh-stat-trend">+2 ce mois</div>
          </div>
          <div class="rh-stat">
            <div class="rh-stat-val" id="st-active">0</div>
            <div class="rh-stat-lbl">Abonn√©s actifs</div>
            <div class="rh-stat-trend">‚Üë +1</div>
          </div>
          <div class="rh-stat">
            <div class="rh-stat-val" id="st-tx">0</div>
            <div class="rh-stat-lbl">Transactions</div>
            <div class="rh-stat-trend">‚Üë +47 sem.</div>
          </div>
          <div class="rh-stat">
            <div class="rh-stat-val" id="st-pending">3</div>
            <div class="rh-stat-lbl">Paiements att.</div>
            <div class="rh-stat-trend" style="color:#fb923c">‚ö† √Ä v√©rifier</div>
          </div>
        </div>
      </div>

      <!-- KPI Cards -->
      <div class="kpi-grid">
        <div class="kpi-card" style="--kc:var(--green);--ki-bg:var(--green-bg)">
          <div class="kpi-hdr"><div class="kpi-icon">üíé</div><span class="kpi-menu">‚Ä¢‚Ä¢‚Ä¢</span></div>
          <div class="kpi-lbl">Revenu moyen / utilisateur</div>
          <div class="kpi-val" id="kpi-avg">‚Äî</div>
          <div class="kpi-footer">
            <div class="kpi-trend trend-up">‚Üë +12% ce mois</div>
            <div class="kpi-lbl" style="font-size:10px">FCFA / user</div>
          </div>
        </div>
        <div class="kpi-card" style="--kc:var(--blue);--ki-bg:var(--blue-bg)">
          <div class="kpi-hdr"><div class="kpi-icon">üì±</div><span class="kpi-menu">‚Ä¢‚Ä¢‚Ä¢</span></div>
          <div class="kpi-lbl">Abonnements actifs</div>
          <div class="kpi-val" id="kpi-subs">‚Äî</div>
          <div class="kpi-footer">
            <div class="kpi-trend trend-up">‚Üë +3 nouveaux</div>
            <div class="kpi-lbl" style="font-size:10px">sur <span id="kpi-total-u">0</span> users</div>
          </div>
        </div>
        <div class="kpi-card" style="--kc:var(--red);--ki-bg:var(--red-bg)">
          <div class="kpi-hdr"><div class="kpi-icon">‚ö†Ô∏è</div><span class="kpi-menu">‚Ä¢‚Ä¢‚Ä¢</span></div>
          <div class="kpi-lbl">Abonnements expir√©s</div>
          <div class="kpi-val" id="kpi-exp">‚Äî</div>
          <div class="kpi-footer">
            <div class="kpi-trend trend-down">√Ä relancer</div>
            <div class="kpi-lbl" style="font-size:10px">√ó500 FCFA / mois</div>
          </div>
        </div>
        <div class="kpi-card" style="--kc:var(--purple);--ki-bg:var(--purple-bg)">
          <div class="kpi-hdr"><div class="kpi-icon">üèÜ</div><span class="kpi-menu">‚Ä¢‚Ä¢‚Ä¢</span></div>
          <div class="kpi-lbl">Meilleur contributeur</div>
          <div class="kpi-val" id="kpi-top" style="font-size:16px;padding-top:4px">‚Äî</div>
          <div class="kpi-footer">
            <div class="kpi-trend trend-up" id="kpi-top-rev">‚Äî</div>
          </div>
        </div>
      </div>

      <!-- Charts row -->
      <div>
        <div class="sec-hdr" style="margin-bottom:12px">
          <div class="sec-title">Analyses & Graphiques</div>
          <div class="sec-actions">
            <button class="btn btn-outline btn-xs">Sem.</button>
            <button class="btn btn-primary btn-xs">Mois</button>
            <button class="btn btn-outline btn-xs">Trim.</button>
          </div>
        </div>
        <div class="charts-row">
          <div class="chart-card">
            <div class="chart-hdr">
              <div><div class="chart-title">Revenus par utilisateur</div><div class="chart-sub">Ce mois ‚Äî en FCFA</div></div>
              <span class="chart-badge cb-green">LIVE</span>
            </div>
            <canvas id="chartUsersRev"></canvas>
          </div>
          <div class="chart-card">
            <div class="chart-hdr">
              <div><div class="chart-title">Statuts abonnements</div><div class="chart-sub">R√©partition globale</div></div>
              <span class="chart-badge cb-blue">Global</span>
            </div>
            <canvas id="chartSubs"></canvas>
            <div class="legend-row" id="subs-legend"></div>
          </div>
          <div class="chart-card">
            <div class="chart-hdr">
              <div><div class="chart-title">Transactions / 7 jours</div><div class="chart-sub">Toutes plateformes</div></div>
              <span class="chart-badge cb-amber">7J</span>
            </div>
            <canvas id="chartTx"></canvas>
          </div>
        </div>
      </div>

      <!-- User table -->
      <div>
        <div class="sec-hdr" style="margin-bottom:12px">
          <div class="sec-title">Performances des utilisateurs</div>
          <div class="sec-actions">
            <button class="btn btn-outline btn-xs" onclick="exportData()">‚¨á CSV</button>
            <button class="btn btn-primary btn-xs" onclick="addUser()">Ôºã Ajouter</button>
          </div>
        </div>
        <div class="table-card">
          <div class="table-toolbar">
            <div class="filter-group">
              <button class="f-tab active" onclick="filterUsers('all',this)">Tous</button>
              <button class="f-tab" onclick="filterUsers('active',this)">Actifs</button>
              <button class="f-tab" onclick="filterUsers('expired',this)">Expir√©s</button>
              <button class="f-tab" onclick="filterUsers('trial',this)">Essai</button>
            </div>
            <div class="search-wrap">
              <span style="color:var(--muted);font-size:13px">üîç</span>
              <input type="text" placeholder="Chercher un utilisateur‚Ä¶" oninput="searchUsers(this.value)">
            </div>
          </div>
          <table class="utbl">
            <thead>
              <tr>
                <th>Utilisateur</th>
                <th>üí∞ Argent g√©n√©r√©</th>
                <th>üìä Transactions</th>
                <th>üìà Performance</th>
                <th>üì¶ Stock principal</th>
                <th>Abonnement</th>
                <th>Dernier acc√®s</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="tbody-main"></tbody>
          </table>
          <div class="table-footer">
            <div class="tf-info">Affichage de <strong id="showing-count">0</strong> utilisateurs sur <strong id="total-count">0</strong></div>
            <div class="tf-info" id="total-rev-footer">Total : <strong style="color:var(--green)">0 FCFA</strong></div>
          </div>
        </div>
      </div>

      <!-- Bottom row -->
      <div class="bottom-row">

        <!-- Live feed -->
        <div class="mini-card">
          <div class="mc-hdr">
            <div class="mc-title">üî¥ Activit√© en direct</div>
            <div class="live-pill" style="font-size:10px;padding:3px 8px"><div class="live-dot"></div>LIVE</div>
          </div>
          <div class="feed-list" id="feed-list"></div>
        </div>

        <!-- Tasks -->
        <div class="mini-card">
          <div class="mc-hdr">
            <div class="mc-title">‚úÖ T√¢ches admin</div>
            <button class="btn btn-outline btn-xs" onclick="addTask()">Ôºã Ajouter</button>
          </div>
          <div class="tasks-list" id="tasks-mini"></div>
        </div>

        <!-- Critical stock -->
        <div class="mini-card">
          <div class="mc-hdr">
            <div class="mc-title">üì¶ Stocks critiques</div>
            <span class="nav-chip chip-red">Alertes</span>
          </div>
          <div class="stock-list" id="stock-list"></div>
        </div>

      </div>
    </div><!-- end page-overview -->

    <!-- ‚ïê‚ïê PAGE USERS ‚ïê‚ïê -->
    <div class="page" id="page-users">
      <div class="page-hdr">
        <div><div class="page-title">Gestion des utilisateurs</div><div class="page-sub" id="users-count-sub">‚Äî</div></div>
        <div class="hdr-actions"><button class="btn btn-primary" onclick="addUser()">Ôºã Nouvel utilisateur</button></div>
      </div>
      <div class="table-card">
        <div class="table-toolbar">
          <div class="filter-group">
            <button class="f-tab active" onclick="filterUsers2('all',this)">Tous</button>
            <button class="f-tab" onclick="filterUsers2('active',this)">Actifs</button>
            <button class="f-tab" onclick="filterUsers2('expired',this)">Expir√©s</button>
          </div>
          <div class="search-wrap">
            <span style="color:var(--muted);font-size:13px">üîç</span>
            <input type="text" placeholder="Rechercher‚Ä¶" oninput="searchUsers2(this.value)">
          </div>
        </div>
        <table class="utbl">
          <thead><tr><th>Utilisateur</th><th>üí∞ Revenus</th><th>üìä Transactions</th><th>Performance</th><th>Abonnement</th><th>Actions</th></tr></thead>
          <tbody id="tbody-users"></tbody>
        </table>
        <div class="table-footer"><div class="tf-info">Total g√©n√©r√© : <strong id="users-total-rev" style="color:var(--green)">0 FCFA</strong></div></div>
      </div>
    </div>

    <!-- ‚ïê‚ïê PAGE STOCK ‚ïê‚ïê -->
    <div class="page" id="page-stock">
      <div class="page-hdr">
        <div><div class="page-title">Stock & Ventes par utilisateur</div><div class="page-sub">Gestion des inventaires en temps r√©el</div></div>
      </div>
      <div class="table-card">
        <table class="utbl">
          <thead><tr><th>Produit</th><th>Utilisateur</th><th>Quantit√©</th><th>Niveau</th><th>Ventes ce mois</th><th>Statut</th></tr></thead>
          <tbody id="tbody-stock"></tbody>
        </table>
      </div>
    </div>

    <!-- ‚ïê‚ïê PAGE REVENUE ‚ïê‚ïê -->
    <div class="page" id="page-revenue">
      <div class="page-hdr">
        <div><div class="page-title">Analyse des revenus</div><div class="page-sub">Revenus d√©taill√©s g√©n√©r√©s par vos utilisateurs</div></div>
      </div>
      <div class="rev-hero">
        <div style="position:relative;z-index:1">
          <div class="rh-label">Total cumul√© ‚Äî tous utilisateurs</div>
          <div class="rh-amount"><span id="rev-total2">0</span><span class="currency">FCFA</span></div>
          <div class="rh-change"><div class="change-badge">‚Üë +23%</div><span class="rh-change-sub">vs mois pr√©c√©dent</span></div>
        </div>
        <div class="rh-stats">
          <div class="rh-stat"><div class="rh-stat-val">45 800</div><div class="rh-stat-lbl">Aujourd'hui</div></div>
          <div class="rh-stat"><div class="rh-stat-val">287 400</div><div class="rh-stat-lbl">Cette semaine</div></div>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:2fr 1fr;gap:14px;">
        <div class="chart-card"><div class="chart-hdr"><div><div class="chart-title">√âvolution mensuelle</div><div class="chart-sub">Revenus cumul√©s 2025‚Äì2026</div></div></div><canvas id="chartRevLine" style="max-height:190px"></canvas></div>
        <div class="chart-card"><div class="chart-hdr"><div><div class="chart-title">Top 5 contributeurs</div><div class="chart-sub">Ce mois</div></div></div><canvas id="chartTop5" style="max-height:190px"></canvas></div>
      </div>
    </div>

    <!-- ‚ïê‚ïê PAGE TASKS ‚ïê‚ïê -->
    <div class="page" id="page-tasks">
      <div class="page-hdr">
        <div><div class="page-title">T√¢ches administratives</div><div class="page-sub">G√©rez vos actions prioritaires</div></div>
        <button class="btn btn-primary" onclick="addTask()">Ôºã Nouvelle t√¢che</button>
      </div>
      <div class="mini-card" style="max-width:560px">
        <div class="tasks-list" id="tasks-full"></div>
      </div>
    </div>

  </main>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DATA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const USERS = [
  {id:1,name:'Fatou Diallo',email:'fatou.d@gmail.com',initials:'FD',color:'#00a86b',revenue:342800,tx:89,status:'active',lastAccess:'Aujourd\'hui',perf:95,stock:{name:'Caf√© Premium',qty:3,max:50,sales:124000}},
  {id:2,name:'Moussa Camara',email:'m.camara@outlook.com',initials:'MC',color:'#2563eb',revenue:287500,tx:72,status:'active',lastAccess:'Hier',perf:82,stock:{name:'Riz import√©',qty:42,max:100,sales:98000}},
  {id:3,name:'Aminata Kon√©',email:'aminata.k@gmail.com',initials:'AK',color:'#d97706',revenue:198200,tx:54,status:'active',lastAccess:'Il y a 2j',perf:67,stock:{name:'Huile palme',qty:85,max:100,sales:76000}},
  {id:4,name:'Ibrahim Tour√©',email:'ibrahim.t@yahoo.fr',initials:'IT',color:'#e53e3e',revenue:156700,tx:41,status:'trial',lastAccess:'Il y a 3j',perf:52,stock:{name:'Savon liquide',qty:18,max:60,sales:54000}},
  {id:5,name:'Mariame Sow',email:'m.sow@gmail.com',initials:'MS',color:'#7c3aed',revenue:134500,tx:38,status:'active',lastAccess:'Aujourd\'hui',perf:48,stock:{name:'Lait concentr√©',qty:7,max:40,sales:43000}},
  {id:6,name:'Ousmane Ba',email:'o.ba@gmail.com',initials:'OB',color:'#0891b2',revenue:98300,tx:29,status:'expired',lastAccess:'Il y a 7j',perf:31,stock:{name:'Sucre roux',qty:24,max:80,sales:32000}},
  {id:7,name:'Aissatou Ndiaye',email:'a.ndiaye@gmail.com',initials:'AN',color:'#be185d',revenue:76400,tx:22,status:'expired',lastAccess:'Il y a 12j',perf:24,stock:{name:'Farine bl√©',qty:11,max:50,sales:28000}},
  {id:8,name:'Cheikh Diop',email:'c.diop@gmail.com',initials:'CD',color:'#047857',revenue:54200,tx:16,status:'trial',lastAccess:'Aujourd\'hui',perf:18,stock:{name:'Tomate conserve',qty:30,max:60,sales:18000}},
];

let TASKS=[
  {id:1,text:'V√©rifier paiements OM de la journ√©e',prio:'high',done:false},
  {id:2,text:'Activer compte d\'Aminata Kon√©',prio:'high',done:false},
  {id:3,text:'Relancer Ousmane Ba ‚Äî abonnement expir√©',prio:'med',done:false},
  {id:4,text:'Envoyer rapport mensuel abonn√©s',prio:'med',done:true},
  {id:5,text:'Mettre √† jour le catalogue stock',prio:'low',done:false},
];

let filterMain='all', searchMain='', filterUsers2State='all', searchUsers2State='';

/* ‚ïê‚ïê COMPUTED ‚ïê‚ïê */
const totalRev = USERS.reduce((a,u)=>a+u.revenue,0);
const totalTx = USERS.reduce((a,u)=>a+u.tx,0);
const activeCount = USERS.filter(u=>u.status==='active').length;
const expiredCount = USERS.filter(u=>u.status==='expired').length;
const avgRev = Math.round(totalRev/USERS.length);

/* ‚ïê‚ïê KPI INIT ‚ïê‚ïê */
function initKPIs(){
  const d = new Date();
  const days=['dimanche','lundi','mardi','mercredi','jeudi','vendredi','samedi'];
  const months=['janvier','f√©vrier','mars','avril','mai','juin','juillet','ao√ªt','septembre','octobre','novembre','d√©cembre'];
  document.getElementById('date-sub').textContent = `${days[d.getDay()]} ${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()} ‚Äî Vue Super Admin`;

  countUp('hero-amount', totalRev, '', true);
  countUp('sb-total', totalRev, '', true);
  document.getElementById('st-users').textContent = USERS.length;
  document.getElementById('st-active').textContent = activeCount;
  countUp('st-tx', totalTx, '', false);
  countUp('kpi-avg', avgRev, '', true);
  document.getElementById('kpi-subs').textContent = activeCount;
  document.getElementById('kpi-total-u').textContent = USERS.length;
  document.getElementById('kpi-exp').textContent = expiredCount;
  document.getElementById('kpi-top').textContent = USERS[0].name.split(' ')[0];
  document.getElementById('kpi-top-rev').textContent = USERS[0].revenue.toLocaleString('fr')+' FCFA';
  if(document.getElementById('rev-total2')) document.getElementById('rev-total2').textContent = totalRev.toLocaleString('fr');
  document.getElementById('users-count-sub').textContent = `${USERS.length} utilisateurs enregistr√©s ‚Ä¢ ${activeCount} actifs ‚Ä¢ ${expiredCount} expir√©s`;
}

function countUp(id, target, sfx, comma){
  const el=document.getElementById(id); if(!el)return;
  const dur=1200; let st;
  const run=(ts)=>{
    if(!st)st=ts;
    const p=Math.min((ts-st)/dur,1), e=1-Math.pow(1-p,3), v=Math.round(e*target);
    el.textContent = comma?v.toLocaleString('fr')+sfx:v+sfx;
    if(p<1)requestAnimationFrame(run);
  };
  requestAnimationFrame(run);
}

/* ‚ïê‚ïê USER TABLE ‚ïê‚ïê */
function getFiltered(f, q){
  return USERS.filter(u=>{
    const mF = f==='all'||u.status===f;
    const mQ = !q||u.name.toLowerCase().includes(q.toLowerCase())||u.email.toLowerCase().includes(q.toLowerCase());
    return mF&&mQ;
  });
}

function rowHTML(u, showStock=true, showAccess=true){
  const mc = u.revenue>200000?'mc-high':u.revenue>100000?'mc-mid':'mc-low';
  const pc = u.perf>70?'#00a86b':u.perf>40?'#d97706':'#e53e3e';
  const stMap={active:'st-active',trial:'st-trial',expired:'st-expired'};
  const stLbl={active:'‚úì Actif',trial:'‚è≥ Essai',expired:'‚úó Expir√©'};
  const stockPct = Math.round((u.stock.qty/u.stock.max)*100);
  const stockColor = stockPct<15?'#e53e3e':stockPct<35?'#d97706':'#00a86b';
  const stockCol = showStock?`<td><div class="stock-mini"><div class="sm-lbl">${u.stock.name}</div><div class="sm-bar"><div class="sm-fill" style="width:${stockPct}%;background:${stockColor}"></div></div><div class="sm-lbl">${u.stock.qty}/${u.stock.max} ‚Äî ${stockPct}%</div></div></td>`:'';
  const accessCol = showAccess?`<td style="font-size:11px;color:var(--muted)">${u.lastAccess}</td>`:'';
  return `<tr>
    <td><div class="u-cell">
      <div class="u-av" style="background:${u.color}18;color:${u.color}">${u.initials}</div>
      <div><div class="u-name">${u.name}</div><div class="u-email">${u.email}</div></div>
    </div></td>
    <td><span class="money-cell ${mc}">${u.revenue.toLocaleString('fr')}</span><span style="font-size:10px;color:var(--muted)"> FCFA</span></td>
    <td><span class="tx-num">${u.tx}</span><span style="font-size:10px;color:var(--muted)"> op√©r.</span></td>
    <td><div class="perf-wrap"><div class="perf-track"><div class="perf-fill" style="width:${u.perf}%;background:${pc}"></div></div><span class="perf-pct" style="color:${pc}">${u.perf}%</span></div></td>
    ${stockCol}
    <td><span class="status-tag ${stMap[u.status]}"><span class="st-dot"></span>${stLbl[u.status]}</span><div class="sub-info" style="margin-top:3px">500 FCFA/mois</div></td>
    ${accessCol}
    <td><div class="act-wrap">
      <button class="act view" onclick="viewUser(${u.id})" title="Voir">üëÅ</button>
      <button class="act edit" onclick="editUser(${u.id})" title="Modifier">‚úè</button>
      <button class="act del" onclick="deleteUser(${u.id})" title="Supprimer">üóë</button>
    </div></td>
  </tr>`;
}

function renderMain(){
  const data=getFiltered(filterMain,searchMain);
  const tbody=document.getElementById('tbody-main'); if(!tbody)return;
  tbody.innerHTML=data.map(u=>rowHTML(u,true,true)).join('');
  document.getElementById('showing-count').textContent=data.length;
  document.getElementById('total-count').textContent=USERS.length;
  const tot=data.reduce((a,u)=>a+u.revenue,0);
  document.getElementById('total-rev-footer').innerHTML=`Total affich√© : <strong style="color:var(--green)">${tot.toLocaleString('fr')} FCFA</strong>`;
}

function renderUsersFull(){
  const data=getFiltered(filterUsers2State,searchUsers2State);
  const tbody=document.getElementById('tbody-users'); if(!tbody)return;
  tbody.innerHTML=data.map(u=>rowHTML(u,false,false)).join('');
  const tot=data.reduce((a,u)=>a+u.revenue,0);
  document.getElementById('users-total-rev').textContent=tot.toLocaleString('fr')+' FCFA';
}

function renderStock(){
  const tbody=document.getElementById('tbody-stock'); if(!tbody)return;
  const allStock=USERS.map(u=>({...u.stock,userName:u.name,userId:u.id,userColor:u.color}));
  tbody.innerHTML=allStock.sort((a,b)=>(a.qty/a.max)-(b.qty/b.max)).map(s=>{
    const pct=Math.round((s.qty/s.max)*100);
    const color=pct<15?'var(--red)':pct<35?'var(--amber)':'var(--green)';
    const tag=pct<15?'<span class="status-tag st-expired">Critique</span>':pct<35?'<span class="status-tag st-trial">Faible</span>':'<span class="status-tag st-active">Normal</span>';
    return `<tr>
      <td style="font-weight:600">${s.name}</td>
      <td><div class="u-cell"><div class="u-av" style="background:${s.userColor}18;color:${s.userColor};font-size:10px;width:28px;height:28px">${USERS.find(u=>u.id===s.userId).initials}</div><span style="font-size:12px">${s.userName}</span></div></td>
      <td><span class="tx-num">${s.qty}</span> / ${s.max}</td>
      <td><div class="perf-wrap"><div class="perf-track"><div class="perf-fill" style="width:${pct}%;background:${color}"></div></div><span class="perf-pct" style="color:${color}">${pct}%</span></div></td>
      <td><span class="money-cell mc-high">${s.sales.toLocaleString('fr')}</span><span style="font-size:10px;color:var(--muted)"> FCFA</span></td>
      <td>${tag}</td>
    </tr>`;
  }).join('');
}

function filterUsers(f,el){filterMain=f;document.querySelectorAll('.f-tab').forEach(b=>b.classList.remove('active'));el.classList.add('active');renderMain();}
function searchUsers(q){searchMain=q;renderMain();}
function filterUsers2(f,el){filterUsers2State=f;document.querySelectorAll('#page-users .f-tab').forEach(b=>b.classList.remove('active'));el.classList.add('active');renderUsersFull();}
function searchUsers2(q){searchUsers2State=q;renderUsersFull();}

function viewUser(id){const u=USERS.find(x=>x.id===id);alert(`üë§ ${u.name}\nüìß ${u.email}\nüí∞ Revenus : ${u.revenue.toLocaleString('fr')} FCFA\nüìä Transactions : ${u.tx}\nüì¶ Stock ${u.stock.name} : ${u.stock.qty}/${u.stock.max}\nüìÖ Dernier acc√®s : ${u.lastAccess}`);}
function editUser(id){const u=USERS.find(x=>x.id===id);const n=prompt('Modifier le nom :',u.name);if(n){u.name=n;renderMain();renderUsersFull();}}
function deleteUser(id){if(confirm('Supprimer cet utilisateur ?')){const i=USERS.findIndex(x=>x.id===id);if(i>-1){USERS.splice(i,1);renderMain();renderUsersFull();}}}
function addUser(){
  const name=prompt('Nom complet :'); if(!name)return;
  const email=prompt('Email :','utilisateur@gmail.com')||'user@jyvos.cm';
  const colors=['#00a86b','#2563eb','#d97706','#7c3aed','#be185d'];
  const color=colors[Math.floor(Math.random()*colors.length)];
  const ini=name.split(' ').map(w=>w[0]).join('').substring(0,2).toUpperCase();
  USERS.push({id:Date.now(),name,email,initials:ini,color,revenue:0,tx:0,status:'trial',lastAccess:'Maintenant',perf:0,stock:{name:'Non d√©fini',qty:0,max:100,sales:0}});
  document.getElementById('chip-users').textContent=USERS.length;
  renderMain();renderUsersFull();renderStock();
  alert(`‚úÖ "${name}" a √©t√© ajout√© en mode Essai.`);
}
function exportData(){alert('üì• Export CSV en cours‚Ä¶\n(Fonctionnalit√© disponible sur la version h√©berg√©e avec backend)');}

/* ‚ïê‚ïê TASKS ‚ïê‚ïê */
function renderTasks(id){
  const el=document.getElementById(id); if(!el)return;
  el.innerHTML=TASKS.map(t=>`<div class="task-item ${t.done?'done':''}" onclick="toggleTask(${t.id},'${id}')">
    <div class="task-cb">${t.done?'‚úì':''}</div>
    <span class="task-lbl">${t.text}</span>
    <span class="task-prio tp-${t.prio[0]}">${t.prio==='high'?'URGENT':t.prio==='med'?'NORMAL':'FAIBLE'}</span>
  </div>`).join('');
}
function toggleTask(id,elId){const t=TASKS.find(x=>x.id===id);if(t){t.done=!t.done;renderTasks(elId);}if(elId==='tasks-mini')renderTasks('tasks-full');}
function addTask(){const text=prompt('Nouvelle t√¢che :');if(!text)return;const prio=prompt('Priorit√© (high/med/low) :','med')||'med';TASKS.unshift({id:Date.now(),text,prio,done:false});renderTasks('tasks-mini');renderTasks('tasks-full');}

/* ‚ïê‚ïê LIVE FEED ‚ïê‚ïê */
const FEED_EVENTS=[
  {ico:'üí∞',bg:'#f0fdf6',text:'<strong>Fatou Diallo</strong> a effectu√© une vente de 15 000 FCFA',amount:'+15 000',t:'Il y a 2 min'},
  {ico:'üì±',bg:'#eff6ff',text:'<strong>Moussa Camara</strong> a renouvel√© son abonnement OM',amount:'+500',t:'Il y a 5 min'},
  {ico:'‚ö†Ô∏è',bg:'#fff7ed',text:'Stock critique : <strong>Caf√© Premium</strong> ‚Äî Fatou Diallo (3 restants)',amount:null,t:'Il y a 8 min'},
  {ico:'‚úÖ',bg:'#f0fdf6',text:'Paiement OM confirm√© pour <strong>Mariame Sow</strong>',amount:'+500',t:'Il y a 14 min'},
  {ico:'üÜï',bg:'#f5f3ff',text:'Nouvel utilisateur inscrit : <strong>Cheikh Diop</strong>',amount:null,t:'Il y a 22 min'},
  {ico:'üìä',bg:'#eff6ff',text:'<strong>Aminata Kon√©</strong> a enregistr√© 8 transactions',amount:'+28 600',t:'Il y a 31 min'},
];
function renderFeed(){
  const el=document.getElementById('feed-list'); if(!el)return;
  el.innerHTML=FEED_EVENTS.map(f=>`<div class="feed-item">
    <div class="feed-ico" style="background:${f.bg}">${f.ico}</div>
    <div class="feed-body"><div class="feed-txt">${f.text}</div><div class="feed-time">${f.t}</div></div>
    ${f.amount?`<div class="feed-amount">${f.amount}</div>`:''}
  </div>`).join('');
}

/* ‚ïê‚ïê STOCK MINI ‚ïê‚ïê */
function renderStockMini(){
  const el=document.getElementById('stock-list'); if(!el)return;
  const critical=USERS.filter(u=>(u.stock.qty/u.stock.max)<0.35).sort((a,b)=>(a.stock.qty/a.stock.max)-(b.stock.qty/b.stock.max));
  el.innerHTML=critical.map(u=>{
    const pct=Math.round((u.stock.qty/u.stock.max)*100);
    const color=pct<15?'var(--red)':pct<35?'var(--amber)':'var(--green)';
    return `<div class="stock-item">
      <div class="st-ico">üì¶</div>
      <div class="st-info"><div class="st-name">${u.stock.name}</div><div class="st-user">${u.name}</div></div>
      <div class="st-right">
        <div class="st-qty" style="color:${color}">${u.stock.qty}/${u.stock.max}</div>
        <div class="st-bar"><div class="st-bar-fill" style="width:${pct}%;background:${color}"></div></div>
      </div>
    </div>`;
  }).join('');
}

/* ‚ïê‚ïê CHARTS ‚ïê‚ïê */
let chartsInited=false;
function initCharts(){
  if(chartsInited)return; chartsInited=true;
  const names=USERS.map(u=>u.name.split(' ')[0]);
  const revs=USERS.map(u=>u.revenue);
  const colors=USERS.map(u=>u.color);

  // Users revenue bar
  new Chart(document.getElementById('chartUsersRev').getContext('2d'),{
    type:'bar',
    data:{labels:names,datasets:[{data:revs,backgroundColor:colors.map(c=>c+'25'),borderColor:colors,borderWidth:2,borderRadius:6,borderSkipped:false}]},
    options:{responsive:true,plugins:{legend:{display:false}},scales:{
      x:{grid:{display:false},ticks:{color:'#8fa0b4',font:{family:'Plus Jakarta Sans',size:10}}},
      y:{grid:{color:'#f0f2f5'},ticks:{color:'#8fa0b4',font:{family:'Plus Jakarta Sans',size:10},callback:v=>v>=1000?(v/1000)+'k':v}}
    }}
  });

  // Subs donut
  const act=USERS.filter(u=>u.status==='active').length;
  const tri=USERS.filter(u=>u.status==='trial').length;
  const exp=USERS.filter(u=>u.status==='expired').length;
  new Chart(document.getElementById('chartSubs').getContext('2d'),{
    type:'doughnut',
    data:{labels:['Actifs','Essai','Expir√©s'],datasets:[{data:[act,tri,exp],backgroundColor:['#00a86b','#d97706','#e53e3e'],borderWidth:2,borderColor:'#ffffff',hoverOffset:5}]},
    options:{responsive:true,cutout:'72%',plugins:{legend:{display:false}}}
  });
  document.getElementById('subs-legend').innerHTML=`
    <div class="leg-item"><div class="leg-left"><div class="leg-dot" style="background:#00a86b"></div>Actifs</div><span class="leg-val">${act}</span></div>
    <div class="leg-item"><div class="leg-left"><div class="leg-dot" style="background:#d97706"></div>Essai</div><span class="leg-val">${tri}</span></div>
    <div class="leg-item"><div class="leg-left"><div class="leg-dot" style="background:#e53e3e"></div>Expir√©s</div><span class="leg-val">${exp}</span></div>`;

  // TX line
  new Chart(document.getElementById('chartTx').getContext('2d'),{
    type:'line',
    data:{labels:['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'],datasets:[{data:[24,31,28,42,38,29,22],borderColor:'#2563eb',backgroundColor:'rgba(37,99,235,0.06)',tension:0.4,pointRadius:4,pointBackgroundColor:'#fff',pointBorderColor:'#2563eb',pointBorderWidth:2,fill:true}]},
    options:{responsive:true,plugins:{legend:{display:false}},scales:{
      x:{grid:{display:false},ticks:{color:'#8fa0b4',font:{family:'Plus Jakarta Sans',size:10}}},
      y:{grid:{color:'#f0f2f5'},ticks:{color:'#8fa0b4',font:{family:'Plus Jakarta Sans',size:10}}}
    }}
  });

  // Revenue line (revenue page)
  setTimeout(()=>{
    const rl=document.getElementById('chartRevLine');
    if(rl&&!rl._chartInstance) new Chart(rl.getContext('2d'),{
      type:'line',
      data:{labels:['Sep','Oct','Nov','D√©c','Jan','F√©v'],datasets:[{label:'Revenus FCFA',data:[512000,687000,598000,821000,743000,1348600],borderColor:'#00a86b',backgroundColor:'rgba(0,168,107,0.07)',tension:0.4,pointRadius:5,pointBackgroundColor:'#fff',pointBorderColor:'#00a86b',pointBorderWidth:2,fill:true}]},
      options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{grid:{display:false},ticks:{color:'#8fa0b4',font:{size:11}}},y:{grid:{color:'#f0f2f5'},ticks:{color:'#8fa0b4',font:{size:11},callback:v=>(v/1000)+'k'}}}}
    });
    const t5=document.getElementById('chartTop5');
    if(t5&&!t5._chartInstance) new Chart(t5.getContext('2d'),{
      type:'bar',
      data:{labels:USERS.slice(0,5).map(u=>u.name.split(' ')[0]),datasets:[{data:USERS.slice(0,5).map(u=>u.revenue),backgroundColor:USERS.slice(0,5).map(u=>u.color+'30'),borderColor:USERS.slice(0,5).map(u=>u.color),borderWidth:2,borderRadius:6,borderSkipped:false}]},
      options:{responsive:true,indexAxis:'y',plugins:{legend:{display:false}},scales:{x:{grid:{color:'#f0f2f5'},ticks:{color:'#8fa0b4',font:{size:10},callback:v=>(v/1000)+'k'}},y:{grid:{display:false},ticks:{color:'#8fa0b4',font:{size:11}}}}}
    });
  },200);
}

/* ‚ïê‚ïê NAVIGATION ‚ïê‚ïê */
function switchPage(id,el){
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  el.classList.add('active');
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  if(id==='users')renderUsersFull();
  if(id==='stock')renderStock();
  if(id==='tasks'){renderTasks('tasks-full');}
}

/* ‚ïê‚ïê CLOCK ‚ïê‚ïê */
function tick(){const n=new Date();document.getElementById('clock').textContent=[n.getHours(),n.getMinutes(),n.getSeconds()].map(v=>String(v).padStart(2,'0')).join(':');}
setInterval(tick,1000);tick();

/* ‚ïê‚ïê BOOT ‚ïê‚ïê */
window.addEventListener('DOMContentLoaded',()=>{
  initKPIs();
  initCharts();
  renderMain();
  renderFeed();
  renderStockMini();
  renderTasks('tasks-mini');
});
</script>
</body>
</html>
