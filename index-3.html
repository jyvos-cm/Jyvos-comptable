<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>JYVOS Comptable</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--primary:#1a56db;--primary-dim:rgba(26,86,219,0.12);--primary-dark:#1240a8;--navy:#0a1628;--navy2:#0f1f3d;--navy3:#162952;--border:rgba(26,86,219,0.22);--border2:rgba(255,255,255,0.07);--text:#e8eef8;--muted:#7b90b8;--muted2:#3d5280;--green:#00c896;--green-dim:rgba(0,200,150,0.12);--red:#ff4d6d;--red-dim:rgba(255,77,109,0.12);--gold:#f0b429;--gold-dim:rgba(240,180,41,0.12);--purple:#a78bfa;--accent:#38bdf8;}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;background:var(--navy);color:var(--text);font-family:'DM Sans',sans-serif;}
.bg{position:fixed;inset:0;z-index:0;pointer-events:none;background:radial-gradient(ellipse at 10% 0%,rgba(26,86,219,.18) 0%,transparent 50%),linear-gradient(180deg,#0a1628 0%,#080f1e 100%);}
@keyframes up{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes pop{from{opacity:0;transform:scale(.93)}to{opacity:1;transform:scale(1)}}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(26,86,219,.5)}50%{box-shadow:0 0 0 10px rgba(26,86,219,0)}}
@keyframes dotA{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-5px)}}
@keyframes inR{from{opacity:0;transform:translateX(16px)}to{opacity:1;transform:translateX(0)}}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
@keyframes aiPulse{0%,100%{box-shadow:0 0 0 0 rgba(167,139,250,.4)}50%{box-shadow:0 0 0 8px rgba(167,139,250,0)}}
.page{display:none;flex-direction:column;height:100%;position:relative;z-index:1;overflow:hidden;}.page.active{display:flex;}
#landing{align-items:center;justify-content:center;padding:24px;overflow-y:auto;}
.lcard{width:100%;max-width:420px;animation:up .5s ease;}
.logo-box{width:64px;height:64px;border-radius:18px;background:linear-gradient(135deg,var(--primary),var(--accent));display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:26px;color:#fff;box-shadow:0 12px 32px rgba(26,86,219,.4);animation:pulse 3s infinite;}
.logo-name{font-size:26px;font-weight:800;letter-spacing:-.5px;}.logo-name span{color:var(--accent);}
.logo-sub{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-top:3px;}
.hero-text{text-align:center;margin-bottom:20px;}.hero-text h1{font-size:21px;font-weight:800;line-height:1.3;margin-bottom:8px;}.hero-text h1 em{color:var(--accent);font-style:normal;}.hero-text p{font-size:13px;color:var(--muted);line-height:1.6;}
.trial-badge{display:inline-flex;align-items:center;gap:6px;background:var(--green-dim);border:1px solid rgba(0,200,150,.25);border-radius:20px;padding:6px 14px;font-size:12px;font-weight:700;color:var(--green);margin-bottom:18px;}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px;}
.lb{padding:18px 12px;border-radius:14px;border:1px solid var(--border2);background:rgba(255,255,255,.03);cursor:pointer;text-align:center;display:flex;flex-direction:column;align-items:center;gap:7px;}.lb:active{transform:scale(.97);}.lb.primary{border-color:var(--border);background:rgba(26,86,219,.12);}.lb .bi{font-size:24px;}.lb .bl{font-size:13px;font-weight:700;}.lb.primary .bl{color:var(--accent);}.lb .bd{font-size:11px;color:var(--muted);}
.lf{width:100%;padding:13px;border-radius:12px;border:1px solid var(--border2);background:rgba(255,255,255,.02);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:9px;font-size:13px;font-weight:600;color:var(--muted);font-family:inherit;margin-top:8px;}
#reg-page,#login-page,#admin-login,#blocked-page{align-items:center;justify-content:center;padding:20px;overflow-y:auto;}
.acard{width:100%;max-width:380px;background:rgba(15,31,61,.9);border:1px solid var(--border);border-radius:20px;padding:28px 24px;box-shadow:0 40px 80px rgba(0,0,0,.5);animation:up .35s ease;}
.aback{display:flex;align-items:center;gap:7px;color:var(--muted);font-size:13px;cursor:pointer;margin-bottom:20px;background:none;border:none;font-family:inherit;}
.atitle{font-size:22px;font-weight:800;margin-bottom:4px;}.asub{font-size:13px;color:var(--muted);margin-bottom:22px;line-height:1.5;}
.fi{margin-bottom:14px;}.fi label{display:block;font-size:11px;color:var(--muted);margin-bottom:6px;font-weight:600;text-transform:uppercase;letter-spacing:.6px;}
.fi input,.fi select,.fi textarea{width:100%;padding:12px 14px;background:rgba(255,255,255,.05);border:1px solid var(--border2);border-radius:10px;color:var(--text);font-size:14px;font-family:inherit;outline:none;transition:all .2s;}
.fi textarea{resize:none;min-height:75px;}.fi input:focus,.fi select:focus{border-color:var(--primary);}.fi select{appearance:none;cursor:pointer;}.fi .hint{font-size:11px;color:var(--muted);margin-top:5px;}
.pw{display:flex;gap:8px;}.pfx{padding:12px;background:rgba(255,255,255,.05);border:1px solid var(--border2);border-radius:10px;color:var(--accent);font-size:12px;font-weight:700;white-space:nowrap;}
.btn-p{width:100%;padding:13px;border-radius:11px;border:none;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;font-size:14px;font-weight:700;cursor:pointer;font-family:inherit;}
.btn-gold{width:100%;padding:13px;border-radius:11px;border:none;background:linear-gradient(135deg,var(--gold),#b8820a);color:#fff;font-size:14px;font-weight:700;cursor:pointer;font-family:inherit;margin-top:8px;}
.btn-o{width:100%;padding:12px;border-radius:11px;border:1px solid rgba(255,255,255,.08);background:transparent;color:var(--muted);font-size:13px;font-family:inherit;cursor:pointer;margin-top:8px;}
.al{padding:11px 14px;border-radius:10px;font-size:13px;margin-bottom:13px;display:none;line-height:1.5;}.al.show{display:block;animation:pop .2s ease;}
.al-e{background:var(--red-dim);border:1px solid rgba(255,77,109,.25);color:var(--red);}
.al-ok{background:var(--green-dim);border:1px solid rgba(0,200,150,.25);color:var(--green);}
.pay-om{background:rgba(0,0,0,.3);border-radius:10px;padding:12px 14px;font-size:12px;line-height:2.2;margin-bottom:14px;border:1px solid rgba(255,255,255,.06);text-align:left;}.pay-om span{color:var(--gold);font-weight:700;}
.pending-box{background:var(--gold-dim);border:1px solid rgba(240,180,41,.25);border-radius:10px;padding:12px 14px;font-size:13px;color:var(--gold);font-weight:600;margin-bottom:14px;line-height:1.5;}
#app{flex-direction:column;}
.topbar{height:56px;background:rgba(10,22,40,.97);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 15px;flex-shrink:0;z-index:50;}
.tb-l{display:flex;align-items:center;gap:10px;}.tb-logo{width:32px;height:32px;border-radius:9px;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;font-weight:800;font-size:14px;color:#fff;}.tb-name{font-size:15px;font-weight:800;}
.tbadge{padding:2px 9px;border-radius:20px;font-size:10px;font-weight:700;text-transform:uppercase;}
.bu{background:rgba(26,86,219,.12);color:var(--accent);border:1px solid rgba(56,189,248,.2);}.bd2{background:var(--gold-dim);color:var(--gold);border:1px solid rgba(240,180,41,.2);}
.tb-r{display:flex;align-items:center;gap:8px;}.av{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;cursor:pointer;background:linear-gradient(135deg,var(--primary),#0e3a9e);color:#fff;}
.logout-btn{padding:5px 11px;border-radius:7px;border:1px solid rgba(255,255,255,.07);background:transparent;color:var(--muted);font-size:11px;cursor:pointer;font-family:inherit;}
.bnav{height:62px;background:rgba(10,22,40,.98);border-top:1px solid var(--border);display:flex;flex-shrink:0;overflow-x:auto;}
.ni{flex:1;min-width:52px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;cursor:pointer;color:var(--muted2);border:none;background:none;position:relative;transition:color .2s;font-family:inherit;}
.ni::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:0;height:2px;background:var(--primary);border-radius:2px 2px 0 0;transition:width .3s;}.ni.active::after{width:28px;}.ni.active{color:var(--accent);}
.ni-ic{font-size:16px;}.ni-lb{font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:.4px;}
.notif-dot{position:absolute;top:8px;right:calc(50% - 14px);width:8px;height:8px;background:var(--red);border-radius:50%;border:2px solid var(--navy);display:none;}
.content{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;}
.tab{display:none;padding:16px;animation:up .3s ease both;}.tab.active{display:block;}
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:11px;}.st{font-size:15px;font-weight:800;}
.btn-add{padding:6px 12px;border-radius:8px;background:rgba(26,86,219,.12);border:1px solid var(--border);color:var(--accent);font-size:12px;font-weight:700;cursor:pointer;font-family:inherit;}
.trial-warn{background:linear-gradient(135deg,rgba(0,200,150,.1),rgba(0,200,150,.03));border:1px solid rgba(0,200,150,.25);border-radius:12px;padding:11px 14px;margin-bottom:14px;display:none;align-items:center;justify-content:space-between;}
.trial-days{font-size:22px;font-weight:800;color:var(--green);font-family:'DM Mono',monospace;}
.wbar{background:linear-gradient(135deg,rgba(26,86,219,.12),rgba(56,189,248,.06));border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:14px;display:flex;align-items:center;gap:12px;}
.wav-big{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;display:flex;align-items:center;justify-content:center;font-size:17px;font-weight:800;flex-shrink:0;}
.capcard{background:linear-gradient(135deg,rgba(0,200,150,.1),rgba(0,200,150,.03));border:1px solid rgba(0,200,150,.2);border-radius:14px;padding:18px;margin-bottom:14px;}
.cap-lb{font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:.6px;margin-bottom:5px;font-weight:600;}
.cap-v{font-size:30px;font-weight:800;color:var(--green);margin-bottom:12px;font-family:'DM Mono',monospace;}
.cap-row{display:flex;gap:9px;}.cap-m{flex:1;background:rgba(0,0,0,.2);border-radius:9px;padding:9px 10px;}
.cap-ml{font-size:10px;color:var(--muted);margin-bottom:2px;font-weight:600;text-transform:uppercase;}.cap-mv{font-size:13px;font-weight:700;font-family:'DM Mono',monospace;}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:14px;}.sc{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:13px;padding:14px;}
.sc-ic{font-size:20px;margin-bottom:8px;}.sc-lb{font-size:10px;color:var(--muted);margin-bottom:3px;font-weight:600;text-transform:uppercase;}.sc-v{font-size:17px;font-weight:800;font-family:'DM Mono',monospace;}
.bank-card{background:linear-gradient(135deg,rgba(167,139,250,.1),rgba(167,139,250,.03));border:1px solid rgba(167,139,250,.2);border-radius:14px;padding:16px;margin-bottom:14px;}
.bank-title{font-size:13px;font-weight:800;color:var(--purple);margin-bottom:12px;}
.bank-tabs{display:flex;gap:6px;margin-bottom:12px;}.btab{flex:1;padding:7px;border-radius:8px;border:1px solid var(--border2);background:transparent;color:var(--muted);font-size:11px;font-weight:700;cursor:pointer;font-family:inherit;}.btab.active{background:rgba(167,139,250,.15);border-color:rgba(167,139,250,.3);color:var(--purple);}
.bank-rows{display:flex;flex-direction:column;gap:8px;}.bank-row{display:flex;align-items:center;justify-content:space-between;background:rgba(0,0,0,.2);border-radius:9px;padding:10px 12px;}.bank-row-l{font-size:12px;color:var(--muted);font-weight:600;}.bank-row-v{font-size:13px;font-weight:800;font-family:'DM Mono',monospace;}
.bank-total-row{display:flex;align-items:center;justify-content:space-between;background:rgba(167,139,250,.12);border:1px solid rgba(167,139,250,.2);border-radius:9px;padding:12px;margin-top:4px;}.bank-total-l{font-size:13px;font-weight:800;color:var(--purple);}.bank-total-v{font-size:16px;font-weight:800;font-family:'DM Mono',monospace;}
.txlist{display:flex;flex-direction:column;gap:8px;}.txi{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:11px;padding:12px 13px;display:flex;align-items:center;gap:11px;}
.txic{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;}.txic.in{background:var(--green-dim);}.txic.out{background:var(--red-dim);}
.txd{flex:1;}.txn{font-size:13px;font-weight:600;margin-bottom:2px;}.txdt{font-size:11px;color:var(--muted);}.txa{font-size:13px;font-weight:700;font-family:'DM Mono',monospace;}.txa.in{color:var(--green);}.txa.out{color:var(--red);}
.empty{text-align:center;padding:32px 20px;color:var(--muted);font-size:13px;}.empty-ic{font-size:36px;margin-bottom:10px;}
.stock-item{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:11px;padding:12px 13px;margin-bottom:8px;display:flex;align-items:center;gap:11px;}
.stock-ic{width:36px;height:36px;border-radius:9px;background:rgba(26,86,219,.12);display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;}
.stock-d{flex:1;}.stock-n{font-size:13px;font-weight:600;margin-bottom:2px;}.stock-c{font-size:11px;color:var(--muted);}
.stock-qty{font-size:14px;font-weight:800;font-family:'DM Mono',monospace;}.stock-qty.low{color:var(--red);}.stock-qty.ok{color:var(--green);}
.stock-alert{font-size:10px;font-weight:700;padding:2px 7px;border-radius:20px;margin-top:2px;}.stock-alert.low{background:var(--red-dim);color:var(--red);}.stock-alert.ok{background:var(--green-dim);color:var(--green);}
.note-item{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:12px;padding:13px;margin-bottom:9px;}.note-item.urgent{border-color:rgba(255,77,109,.3);background:rgba(255,77,109,.04);}.note-item.done{opacity:.45;}
.note-top{display:flex;gap:9px;margin-bottom:8px;}.note-ic{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;}.note-ic.rappel{background:var(--gold-dim);}.note-ic.note{background:rgba(26,86,219,.12);}
.note-ti{font-size:13px;font-weight:700;margin-bottom:3px;}.note-bd{font-size:12px;color:var(--muted);line-height:1.5;}
.note-foot{display:flex;align-items:center;justify-content:space-between;margin-top:9px;}
.alarm-badge{display:inline-flex;align-items:center;gap:4px;background:var(--gold-dim);border:1px solid rgba(240,180,41,.2);border-radius:20px;padding:2px 8px;font-size:10px;font-weight:700;color:var(--gold);}
.note-btns{display:flex;gap:6px;}.nbtn{padding:4px 9px;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;border:none;font-family:inherit;}.nbtn.ok{background:var(--green-dim);color:var(--green);}.nbtn.del{background:var(--red-dim);color:var(--red);}
.ep-hero{background:linear-gradient(135deg,rgba(167,139,250,.12),rgba(167,139,250,.04));border:1px solid rgba(167,139,250,.2);border-radius:14px;padding:16px;margin-bottom:14px;text-align:center;}
.ep-score{font-size:44px;font-weight:800;color:var(--purple);font-family:'DM Mono',monospace;}.ep-lb{font-size:12px;color:var(--muted);margin-bottom:12px;}
.ep-bar{background:rgba(255,255,255,.06);border-radius:8px;height:10px;overflow:hidden;margin-bottom:8px;}.ep-fill{height:100%;border-radius:8px;background:linear-gradient(90deg,var(--red),var(--gold),var(--green));transition:width 1.2s;}.ep-msg{font-size:12px;color:var(--muted);}
.conseil-item{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:12px;padding:13px;margin-bottom:9px;display:flex;gap:10px;}.conseil-ic{font-size:20px;flex-shrink:0;margin-top:2px;}.conseil-t{font-size:13px;font-weight:700;margin-bottom:4px;}.conseil-d{font-size:12px;color:var(--muted);line-height:1.5;}
.conseil-tag{display:inline-block;margin-top:6px;padding:2px 8px;border-radius:20px;font-size:10px;font-weight:700;}.tc{background:var(--red-dim);color:var(--red);}.ti{background:var(--gold-dim);color:var(--gold);}.tok{background:var(--green-dim);color:var(--green);}
/* CALCULS */
.calc-toolbar{display:flex;gap:7px;flex-wrap:wrap;margin-bottom:12px;}
.calc-btn{padding:7px 12px;border-radius:8px;border:1px solid var(--border2);background:rgba(255,255,255,.04);color:var(--muted);font-size:11px;font-weight:700;cursor:pointer;font-family:inherit;}.calc-btn:active{transform:scale(.96);}.calc-btn.cp{background:rgba(26,86,219,.12);border-color:var(--border);color:var(--accent);}.calc-btn.cd{background:var(--red-dim);border-color:rgba(255,77,109,.2);color:var(--red);}
.calc-wrap{overflow-x:auto;border-radius:12px;border:1px solid var(--border2);background:rgba(255,255,255,.02);margin-bottom:12px;}
.calc-table{border-collapse:collapse;min-width:100%;font-size:12px;}
.calc-table th{background:rgba(26,86,219,.1);padding:8px 6px;text-align:center;font-weight:700;color:var(--accent);border:1px solid var(--border2);white-space:nowrap;font-size:10px;}
.calc-table th input{background:transparent;border:none;color:var(--accent);font-weight:700;font-size:10px;font-family:inherit;width:72px;text-align:center;outline:none;}
.calc-table td{border:1px solid var(--border2);padding:0;}
.calc-table td input{width:100%;min-width:72px;padding:7px 8px;background:transparent;border:none;color:var(--text);font-size:12px;font-family:'DM Mono',monospace;outline:none;text-align:right;}
.calc-table td input:focus{background:rgba(26,86,219,.08);}
.calc-table td.rl input{text-align:left;font-family:'DM Sans',sans-serif;font-weight:600;color:var(--muted);}
.calc-table tr.tr{background:rgba(167,139,250,.08);}
.calc-table tr.tr td input{color:var(--purple);font-weight:700;pointer-events:none;text-align:right;}
.calc-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:12px;}
.calc-card{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:12px;padding:12px;}
.calc-card-ic{font-size:18px;margin-bottom:5px;}.calc-card-lb{font-size:10px;color:var(--muted);margin-bottom:3px;font-weight:600;text-transform:uppercase;}.calc-card-v{font-size:15px;font-weight:800;font-family:'DM Mono',monospace;}
.tva-box{background:rgba(56,189,248,.06);border:1px solid rgba(56,189,248,.15);border-radius:12px;padding:14px;margin-bottom:12px;}
.tva-title{font-size:12px;font-weight:800;color:var(--accent);margin-bottom:10px;}
.tva-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:7px;}
.tva-l{font-size:12px;color:var(--muted);}.tva-v{font-size:13px;font-weight:700;font-family:'DM Mono',monospace;}
/* AIDE */
.aide-hero{background:linear-gradient(135deg,rgba(56,189,248,.1),rgba(56,189,248,.03));border:1px solid rgba(56,189,248,.2);border-radius:14px;padding:18px;margin-bottom:16px;text-align:center;}
.aide-st{font-size:13px;font-weight:800;color:var(--accent);margin-bottom:10px;padding-left:10px;border-left:3px solid var(--primary);}
.aide-step{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:11px;padding:12px 14px;margin-bottom:8px;display:flex;gap:10px;align-items:flex-start;}
.aide-num{width:24px;height:24px;border-radius:50%;background:rgba(26,86,219,.15);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:var(--accent);flex-shrink:0;margin-top:1px;}
.aide-step-t{font-size:13px;font-weight:700;margin-bottom:3px;}.aide-step-d{font-size:12px;color:var(--muted);line-height:1.5;}
.lang-toggle{display:flex;gap:8px;margin-bottom:16px;}.lang-btn{flex:1;padding:8px;border-radius:9px;border:1px solid var(--border2);background:transparent;color:var(--muted);font-size:12px;font-weight:700;cursor:pointer;font-family:inherit;}.lang-btn.active{background:rgba(26,86,219,.12);border-color:var(--border);color:var(--accent);}
.creator-card{background:linear-gradient(135deg,rgba(26,86,219,.1),rgba(56,189,248,.05));border:1px solid var(--border);border-radius:16px;padding:20px;margin-bottom:14px;text-align:center;}
.creator-av{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));display:flex;align-items:center;justify-content:center;font-size:26px;font-weight:800;color:#fff;margin:0 auto 12px;}
.creator-n{font-size:15px;font-weight:800;margin-bottom:3px;}.creator-r{font-size:12px;color:var(--accent);font-weight:700;margin-bottom:10px;}.creator-d{font-size:12px;color:var(--muted);line-height:1.7;margin-bottom:14px;}
.creator-links{display:flex;flex-direction:column;gap:8px;}.creator-link{display:flex;align-items:center;gap:10px;background:rgba(255,255,255,.04);border:1px solid var(--border2);border-radius:10px;padding:10px 14px;font-size:12px;font-weight:600;color:var(--text);}
.creator-link-ic{font-size:18px;flex-shrink:0;}.creator-link-d{font-size:11px;color:var(--muted);margin-top:1px;}
/* PROFIL */
.pcard{background:linear-gradient(135deg,rgba(26,86,219,.1),rgba(56,189,248,.05));border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:14px;text-align:center;}
.pav{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:800;margin:0 auto 10px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));color:#fff;}
.pn{font-size:17px;font-weight:800;}.pe{font-size:12px;color:var(--muted);margin-top:3px;}
.prow{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:13px;overflow:hidden;margin-bottom:13px;}
.pr{display:flex;align-items:center;justify-content:space-between;padding:13px 15px;border-bottom:1px solid rgba(255,255,255,.04);cursor:pointer;}.pr:last-child{border-bottom:none;}.pr-l{font-size:13px;font-weight:600;}.pr-d{font-size:11px;color:var(--muted);margin-top:2px;}
.sec-panel{background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:13px;padding:16px;margin-bottom:13px;}
.sec-row{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,.04);}.sec-row:last-child{border-bottom:none;}.sec-l{font-size:13px;font-weight:600;}.sec-d{font-size:11px;color:var(--muted);margin-top:2px;}
.tog{width:44px;height:24px;background:var(--navy3);border-radius:12px;position:relative;cursor:pointer;transition:background .3s;border:none;flex-shrink:0;}.tog.on{background:linear-gradient(135deg,var(--primary),var(--primary-dark));}.tog::after{content:'';position:absolute;top:3px;left:3px;width:18px;height:18px;background:#fff;border-radius:50%;transition:transform .3s;}.tog.on::after{transform:translateX(20px);}
/* ADMIN */
#admin-panel{flex-direction:column;}
.anav{display:flex;overflow-x:auto;background:rgba(10,22,40,.97);border-bottom:1px solid var(--border);flex-shrink:0;scrollbar-width:none;}.anav::-webkit-scrollbar{display:none;}
.at{padding:14px 16px;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap;color:var(--muted);border-bottom:2px solid transparent;transition:all .2s;text-transform:uppercase;}.at.active{color:var(--accent);border-bottom-color:var(--primary);}
.asg{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:16px;}.as{background:rgba(255,255,255,.03);border:1px solid var(--border2);border-radius:13px;padding:15px;}.as-ic{font-size:22px;margin-bottom:8px;}.as-lb{font-size:10px;color:var(--muted);margin-bottom:3px;font-weight:600;text-transform:uppercase;}.as-v{font-size:20px;font-weight:800;font-family:'DM Mono',monospace;}
.demand-item{background:rgba(255,255,255,.03);border:1px solid rgba(240,180,41,.25);border-radius:12px;padding:14px;margin-bottom:10px;}
.demand-top{display:flex;align-items:center;gap:10px;margin-bottom:10px;}.demand-av{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--primary-dark));display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:#fff;flex-shrink:0;}
.demand-n{font-size:13px;font-weight:700;}.demand-d{font-size:11px;color:var(--muted);}
.demand-btns{display:flex;gap:8px;}.dbtn{flex:1;padding:9px;border-radius:9px;font-size:12px;font-weight:700;cursor:pointer;border:none;font-family:inherit;}.dbtn.approve{background:var(--green-dim);color:var(--green);border:1px solid rgba(0,200,150,.25);}.dbtn.reject{background:var(--red-dim);color:var(--red);border:1px solid rgba(255,77,109,.25);}
/* MODAL */
.mb{display:none;position:fixed;inset:0;z-index:300;background:rgba(0,0,0,.75);backdrop-filter:blur(8px);align-items:flex-end;justify-content:center;}.mb.open{display:flex;}
.mod{background:var(--navy2);border:1px solid var(--border);border-radius:20px 20px 0 0;padding:22px 18px 30px;width:100%;max-width:480px;animation:up .3s ease;max-height:90vh;overflow-y:auto;}
.mod-t{font-size:16px;font-weight:800;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;}.mod-x{cursor:pointer;color:var(--muted);font-size:22px;background:none;border:none;line-height:1;}
/* CHAT IA */
.ai-ov{display:none;position:fixed;inset:0;z-index:200;flex-direction:column;background:var(--navy);}.ai-ov.open{display:flex;animation:inR .3s ease;}
.ai-hd{padding:12px 14px;border-bottom:1px solid var(--border2);display:flex;align-items:center;gap:10px;background:rgba(10,22,40,.98);flex-shrink:0;}
.ai-back{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--muted);font-size:20px;background:none;border:none;}
.ai-av{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,var(--purple),#6d28d9);display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;animation:aiPulse 3s infinite;}
.ai-hi{flex:1;}.ai-hn{font-size:14px;font-weight:800;}.ai-hs{font-size:11px;color:var(--purple);display:flex;align-items:center;gap:4px;}
.ai-dot{width:6px;height:6px;background:var(--purple);border-radius:50%;animation:blink 1.5s infinite;}
.ai-msgs{flex:1;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:10px;scroll-behavior:smooth;}
.bbl{max-width:85%;padding:11px 14px;border-radius:14px;font-size:13px;line-height:1.6;}
.bbl.u{background:rgba(26,86,219,.12);border:1px solid var(--border);align-self:flex-end;border-bottom-right-radius:3px;}
.bbl.b{background:rgba(167,139,250,.08);border:1px solid rgba(167,139,250,.15);align-self:flex-start;border-bottom-left-radius:3px;}
.bbl .bt{font-size:10px;color:var(--muted);margin-top:5px;}.bbl.u .bt{text-align:right;}.bbl.b .bt{text-align:left;}
.tping{display:flex;gap:4px;align-items:center;padding:12px 14px;background:rgba(167,139,250,.08);border:1px solid rgba(167,139,250,.15);border-radius:14px;border-bottom-left-radius:3px;align-self:flex-start;width:54px;}
.tdot{width:6px;height:6px;background:var(--muted);border-radius:50%;animation:dotA 1.4s infinite;}.tdot:nth-child(2){animation-delay:.2s;}.tdot:nth-child(3){animation-delay:.4s;}
.ai-chips{display:flex;gap:7px;flex-wrap:wrap;padding:10px 14px;border-top:1px solid var(--border2);background:rgba(10,22,40,.97);}
.ai-chip{padding:6px 12px;border-radius:20px;border:1px solid var(--border2);background:rgba(255,255,255,.04);font-size:11px;font-weight:600;color:var(--muted);cursor:pointer;white-space:nowrap;}
.ai-inp{padding:10px 12px;border-top:1px solid var(--border2);display:flex;gap:9px;background:rgba(10,22,40,.98);flex-shrink:0;}
.ai-cinp{flex:1;padding:11px 14px;background:rgba(255,255,255,.05);border:1px solid var(--border2);border-radius:22px;color:var(--text);font-size:14px;font-family:inherit;outline:none;}
.ai-snd{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,var(--purple),#6d28d9);border:none;cursor:pointer;font-size:17px;color:#fff;}
.fab{position:fixed;bottom:76px;right:16px;width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,var(--purple),#6d28d9);border:none;cursor:pointer;font-size:22px;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 24px rgba(109,40,217,.45);z-index:99;animation:aiPulse 3s infinite;}
</style>
</head>
<body>
<div class="bg"></div>

<!-- LANDING -->
<div id="landing" class="page active">
  <div class="lcard">
    <div style="text-align:center;margin-bottom:24px;">
      <div class="logo-box">J</div>
      <div class="logo-name" style="margin-top:10px;">JY<span>VOS</span> Comptable</div>
      <div class="logo-sub">Gestion financi√®re professionnelle</div>
    </div>
    <div class="hero-text">
      <h1>G√©rez vos <em>finances</em> avec pr√©cision et intelligence</h1>
      <p>Transactions ¬∑ Stock ¬∑ IA ¬∑ √âpargne ¬∑ Banque ¬∑ Calculs Excel</p>
    </div>
    <div style="text-align:center;margin-bottom:18px;"><span class="trial-badge">üéÅ 7 jours gratuits ¬∑ Puis 500 FCFA unique √† vie</span></div>
    <div class="grid2">
      <div class="lb primary" onclick="showPage('reg-page')"><div class="bi">üöÄ</div><div class="bl">Commencer</div><div class="bd">Cr√©er un compte</div></div>
      <div class="lb" onclick="showPage('login-page')"><div class="bi">üîê</div><div class="bl">Connexion</div><div class="bd">J'ai un compte</div></div>
    </div>

    <button class="lf" onclick="showPage('admin-login')">üõ°Ô∏è Acc√®s Administrateur</button>
  </div>
</div>

<!-- INSCRIPTION -->
<div id="reg-page" class="page">
  <div class="acard" style="margin:auto;">
    <button class="aback" onclick="showPage('landing')">‚Üê Retour</button>
    <div class="atitle">Cr√©er un compte</div>
    <div class="asub">üéÅ 7 jours gratuits ¬∑ Puis 500 FCFA unique √† vie</div>
    <div id="reg-alert" class="al"></div>
    <div class="fi"><label>Nom complet</label><input type="text" id="reg-nom" placeholder="Jean Dupont"></div>
    <div class="fi"><label>Email</label><input type="email" id="reg-email" placeholder="jean@exemple.com"></div>
    <div class="fi"><label>Entreprise</label><input type="text" id="reg-ent" placeholder="Ma Boutique SARL"></div>
    <div class="fi"><label>R√¥le</label><select id="reg-role"><option value="gerant">G√©rant</option><option value="comptable">Comptable</option><option value="employe">Employ√©</option></select></div>
    <div class="fi"><label>Mot de passe</label><div class="pw"><div class="pfx">JYVOS-</div><input type="text" id="reg-pw" placeholder="votre code" style="flex:1;"></div><div class="hint">Ex: JYVOS-2024 ¬∑ M√©morisez-le bien</div></div>
    <button class="btn-p" onclick="register()">D√©marrer mon essai gratuit ‚Üí</button>
    <button class="btn-o" onclick="showPage('login-page')">J'ai d√©j√† un compte</button>
  </div>
</div>

<!-- CONNEXION -->
<div id="login-page" class="page">
  <div class="acard" style="margin:auto;">
    <button class="aback" onclick="showPage('landing')">‚Üê Retour</button>
    <div class="atitle">Connexion</div>
    <div class="asub">Acc√©dez √† votre espace JYVOS</div>
    <div id="login-alert" class="al"></div>
    <div class="fi"><label>Email</label><input type="email" id="login-email" placeholder="jean@exemple.com"></div>
    <div class="fi"><label>Mot de passe</label><div class="pw"><div class="pfx">JYVOS-</div><input type="text" id="login-pw" placeholder="votre code" style="flex:1;"></div></div>
    <button class="btn-p" onclick="login()">Se connecter ‚Üí</button>
    <button class="btn-o" onclick="showPage('reg-page')">Cr√©er un compte</button>
  </div>
</div>

<!-- ADMIN LOGIN -->
<div id="admin-login" class="page">
  <div class="acard" style="margin:auto;">
    <button class="aback" onclick="showPage('landing')">‚Üê Retour</button>
    <div class="atitle">üõ°Ô∏è Administration</div>
    <div class="asub">Acc√®s super-administrateur JYVOS</div>
    <div id="adm-alert" class="al"></div>
    <div class="fi"><label>Code Admin</label><input type="password" id="adm-pw" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
    <button class="btn-p" onclick="adminLogin()">Acc√®s Admin ‚Üí</button>
  </div>
</div>

<!-- PAGE BLOQU√âE -->
<div id="blocked-page" class="page">
  <div class="acard" style="margin:auto;border-color:rgba(255,77,109,.3);">
    <div style="font-size:44px;text-align:center;margin-bottom:12px;">üîí</div>
    <div style="font-size:18px;font-weight:800;color:var(--red);text-align:center;margin-bottom:8px;">Essai de 7 jours expir√©</div>
    <div style="font-size:13px;color:var(--muted);line-height:1.6;margin-bottom:16px;text-align:center;">Effectuez le paiement unique de <strong style="color:var(--gold)">500 FCFA</strong> puis soumettez votre demande.</div>
    <div class="pay-om">üì± <strong>Orange Money</strong><br>Num√©ro : <span>691 928 061</span><br>Nom : <span>NGAH NTSAMA</span><br>Montant : <span>500 FCFA ¬∑ Paiement unique √† vie</span></div>
    <div id="blocked-alert" class="al"></div>
    <div id="pending-box" class="pending-box" style="display:none;">‚è≥ Demande envoy√©e !<br>L'administrateur va activer votre acc√®s tr√®s bient√¥t.</div>
    <button class="btn-gold" id="demand-btn" onclick="sendDemand()">‚úÖ J'ai pay√© ¬∑ Demander l'acc√®s</button>
    <button class="btn-o" onclick="logout()">‚Üê Retour √† l'accueil</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="page">
  <div class="topbar">
    <div class="tb-l"><div class="tb-logo">J</div><div class="tb-name">JYVOS</div><span class="tbadge bu" id="role-badge">G√©rant</span></div>
    <div class="tb-r"><div class="av" id="user-av" onclick="goTab('profil')">JD</div><button class="logout-btn" onclick="logout()">Quitter</button></div>
  </div>
  <div class="content">
    <!-- DASHBOARD -->
    <div id="tab-dashboard" class="tab active">
      <div class="wbar"><div class="wav-big" id="dash-av">JD</div><div><div style="font-size:14px;font-weight:700;" id="dash-welcome">Bonjour üëã</div><div style="font-size:12px;color:var(--muted);" id="dash-date"></div></div></div>
      <div id="trial-warn" class="trial-warn"><div><div style="font-size:12px;font-weight:700;color:var(--green);">üéÅ Essai gratuit en cours</div><div style="font-size:11px;color:var(--muted);">Jours restants</div></div><div class="trial-days" id="trial-days">7</div></div>
      <div class="capcard">
        <div class="cap-lb">üí∞ Capital disponible</div>
        <div class="cap-v" id="capital-val">0 FCFA</div>
        <div class="cap-row">
          <div class="cap-m"><div class="cap-ml">üìà Revenus</div><div class="cap-mv" id="rev-val" style="color:var(--green)">0 FCFA</div></div>
          <div class="cap-m"><div class="cap-ml">üìâ D√©penses</div><div class="cap-mv" id="dep-val" style="color:var(--red)">0 FCFA</div></div>
        </div>
      </div>
      <div class="bank-card">
        <div class="bank-title">üè¶ Totalisation Bancaire</div>
        <div class="bank-tabs">
          <button class="btab active" onclick="switchBankTab(this,'jour')">üìÖ Jour</button>
          <button class="btab" onclick="switchBankTab(this,'semaine')">üìÜ Semaine</button>
          <button class="btab" onclick="switchBankTab(this,'mois')">üóìÔ∏è Mois</button>
        </div>
        <div class="bank-rows" id="bank-rows"></div>
      </div>
      <div class="g2">
        <div class="sc"><div class="sc-ic">üì¶</div><div class="sc-lb">Stock</div><div class="sc-v" id="stock-count">0</div></div>
        <div class="sc"><div class="sc-ic">‚ö†Ô∏è</div><div class="sc-lb">Alertes</div><div class="sc-v" id="alert-count" style="color:var(--red)">0</div></div>
        <div class="sc"><div class="sc-ic">üí≥</div><div class="sc-lb">Transactions</div><div class="sc-v" id="tx-count">0</div></div>
        <div class="sc"><div class="sc-ic">üìù</div><div class="sc-lb">Rappels</div><div class="sc-v" id="notes-count" style="color:var(--gold)">0</div></div>
      </div>
      <div class="sh"><div class="st">Derni√®res transactions</div><button class="btn-add" onclick="goTab('transactions')">Voir tout</button></div>
      <div class="txlist" id="dash-tx"></div>
    </div>
    <!-- TRANSACTIONS -->
    <div id="tab-transactions" class="tab">
      <div class="sh"><div class="st">üí≥ Transactions</div><button class="btn-add" onclick="openModal('tx-modal')">+ Ajouter</button></div>
      <div class="txlist" id="tx-list"></div>
    </div>
    <!-- STOCK -->
    <div id="tab-stock" class="tab">
      <div class="sh"><div class="st">üì¶ Stock</div><button class="btn-add" onclick="openModal('stock-modal')">+ Produit</button></div>
      <div id="stock-list"></div>
    </div>
    <!-- NOTES -->
    <div id="tab-notes" class="tab">
      <div class="sh"><div class="st">üìù Notes & Rappels</div><button class="btn-add" onclick="openModal('note-modal')">+ Ajouter</button></div>
      <div id="notes-list"></div>
    </div>
    <!-- EPARGNE -->
    <div id="tab-epargne" class="tab">
      <div class="sh"><div class="st">üí° Conseils √âpargne IA</div></div>
      <div class="ep-hero"><div class="ep-score" id="ep-score">‚Äî</div><div class="ep-lb">Score √©pargne / 100</div><div class="ep-bar"><div class="ep-fill" id="ep-fill" style="width:0%"></div></div><div class="ep-msg" id="ep-msg">Ajoutez des transactions pour vos conseils.</div></div>
      <div id="conseils-list"></div>
    </div>
    <!-- CALCULS -->
    <div id="tab-calculs" class="tab">
      <div class="sh"><div class="st">üßÆ Tableau de Calcul</div></div>
      <div class="calc-toolbar">
        <button class="calc-btn cp" onclick="addCalcRow()">+ Ligne</button>
        <button class="calc-btn cp" onclick="addCalcCol()">+ Colonne</button>
        <button class="calc-btn" onclick="clearCalc()">üîÑ R√©initialiser</button>
        <button class="calc-btn cd" onclick="delLastRow()">‚àí Ligne</button>
      </div>
      <div class="calc-wrap"><table class="calc-table" id="calc-table"></table></div>
      <div class="calc-grid" id="calc-grid"></div>
      <div class="tva-box">
        <div class="tva-title">üìä Calculs automatiques (TVA 19.25% ¬∑ Cameroun)</div>
        <div class="tva-row"><span class="tva-l">Total HT</span><span class="tva-v" id="tva-ht">0 FCFA</span></div>
        <div class="tva-row"><span class="tva-l">TVA 19.25%</span><span class="tva-v" id="tva-val" style="color:var(--gold)">0 FCFA</span></div>
        <div class="tva-row"><span class="tva-l">Total TTC</span><span class="tva-v" id="tva-ttc" style="color:var(--green)">0 FCFA</span></div>
        <div class="tva-row"><span class="tva-l">Marge brute</span><span class="tva-v" id="tva-marge" style="color:var(--purple)">‚Äî</span></div>
      </div>
    </div>
    <!-- AIDE -->
    <div id="tab-aide" class="tab">
      <div class="aide-hero">
        <div style="font-size:36px;margin-bottom:8px;">üìñ</div>
        <div style="font-size:16px;font-weight:800;margin-bottom:6px;">Guide JYVOS Comptable</div>
        <div style="font-size:12px;color:var(--muted);">Comment utiliser ¬∑ How to use</div>
      </div>
      <div class="lang-toggle">
        <button class="lang-btn active" id="lang-fr" onclick="setLang('fr')">üá´üá∑ Fran√ßais</button>
        <button class="lang-btn" id="lang-en" onclick="setLang('en')">üá¨üáß English</button>
      </div>
      <div id="guide-fr">
        <div style="margin-bottom:14px;"><div class="aide-st">üí≥ Enregistrer une transaction</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">Aller dans Finances</div><div class="aide-step-d">Onglet üí≥ en bas de l'√©cran.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Cliquer + Ajouter</div><div class="aide-step-d">Bouton en haut √† droite.</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">Choisir le type</div><div class="aide-step-d">üìà Entr√©e = re√ßu ¬∑ üìâ Sortie = d√©pens√©</div></div></div>
          <div class="aide-step"><div class="aide-num">4</div><div><div class="aide-step-t">Remplir et enregistrer</div><div class="aide-step-d">Description, montant, cat√©gorie ‚Üí Enregistrer ‚úÖ</div></div></div>
        </div>
        <div style="margin-bottom:14px;"><div class="aide-st">üßÆ Tableau de calcul Excel</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">Aller dans Calculs</div><div class="aide-step-d">Onglet üßÆ en bas de l'√©cran.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Saisir les donn√©es</div><div class="aide-step-d">Remplissez D√©signation, Qt√©, Prix. Le Montant se calcule automatiquement !</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">Ajouter lignes/colonnes</div><div class="aide-step-d">Boutons + Ligne et + Colonne pour agrandir le tableau.</div></div></div>
          <div class="aide-step"><div class="aide-num">4</div><div><div class="aide-step-t">Voir les totaux</div><div class="aide-step-d">TVA 19.25%, Total TTC et Marge brute calcul√©s automatiquement.</div></div></div>
        </div>
        <div style="margin-bottom:14px;"><div class="aide-st">üè¶ Totalisation bancaire</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">Sur le tableau de bord</div><div class="aide-step-d">Section üè¶ avec totaux Jour / Semaine / Mois.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Solde net</div><div class="aide-step-d">Entr√©es - Sorties = Solde net. Id√©al pour la cl√¥ture journali√®re.</div></div></div>
        </div>
        <div style="margin-bottom:14px;"><div class="aide-st">üí∞ Paiement et activation</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">7 jours gratuits</div><div class="aide-step-d">Testez tout gratuitement pendant 7 jours apr√®s inscription.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Payer 500 FCFA</div><div class="aide-step-d">Orange Money ‚Üí 691 928 061 (NGAH NTSAMA). Paiement unique, acc√®s √† vie.</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">Demander l'activation</div><div class="aide-step-d">Cliquez "J'ai pay√© ¬∑ Demander l'acc√®s". L'admin active votre compte.</div></div></div>
        </div>
      </div>
      <div id="guide-en" style="display:none;">
        <div style="margin-bottom:14px;"><div class="aide-st">üí≥ Record a transaction</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">Go to Finances</div><div class="aide-step-d">Tap the üí≥ tab at the bottom.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Click + Add</div><div class="aide-step-d">Button at top right.</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">Choose type</div><div class="aide-step-d">üìà Income = received ¬∑ üìâ Expense = spent</div></div></div>
          <div class="aide-step"><div class="aide-num">4</div><div><div class="aide-step-t">Fill and save</div><div class="aide-step-d">Description, amount, category ‚Üí Save ‚úÖ</div></div></div>
        </div>
        <div style="margin-bottom:14px;"><div class="aide-st">üßÆ Excel calculation table</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">Go to Calculs tab</div><div class="aide-step-d">Tap the üßÆ tab at the bottom.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Enter data</div><div class="aide-step-d">Fill in Description, Qty, Price. Amount calculates automatically!</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">View totals</div><div class="aide-step-d">VAT 19.25%, Total incl. tax and gross margin calculated automatically.</div></div></div>
        </div>
        <div style="margin-bottom:14px;"><div class="aide-st">üí∞ Payment & activation</div>
          <div class="aide-step"><div class="aide-num">1</div><div><div class="aide-step-t">7 days free trial</div><div class="aide-step-d">Test everything free for 7 days after registration.</div></div></div>
          <div class="aide-step"><div class="aide-num">2</div><div><div class="aide-step-t">Pay 500 FCFA</div><div class="aide-step-d">Orange Money ‚Üí 691 928 061 (NGAH NTSAMA). One-time, lifetime access.</div></div></div>
          <div class="aide-step"><div class="aide-num">3</div><div><div class="aide-step-t">Request activation</div><div class="aide-step-d">Click "I paid ¬∑ Request access". Admin activates your account.</div></div></div>
        </div>
      </div>
      <div class="creator-card">
        <div class="creator-av">N</div>
        <div class="creator-n">Nkoudou Amougou Jean Pascal Yves</div>
        <div class="creator-r">Fondateur &amp; D√©veloppeur ¬∑ JYVOS Comptable</div>
        <div class="creator-d">Passionn√© de technologie et d'entrepreneuriat, j'ai cr√©√© JYVOS Comptable pour aider les commer√ßants et entrepreneurs africains √† mieux g√©rer leurs finances, suivre leur stock et prendre de meilleures d√©cisions gr√¢ce √† l'intelligence artificielle.<br><br>üá®üá≤ Cameroun ¬∑ 2026</div>
        <div class="creator-links">
          <div class="creator-link"><div class="creator-link-ic">üìß</div><div><div><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="452f20242b3524362624293c3320362b2e2a30212a3024282a30222a30052228242c296b262a28">[email&#160;protected]</a></div><div class="creator-link-d">Email ¬∑ Contactez-moi</div></div></div>
          <div class="creator-link"><div class="creator-link-ic">üì±</div><div><div>691 928 061</div><div class="creator-link-d">Orange Money ¬∑ Paiement JYVOS</div></div></div>
          <div class="creator-link"><div class="creator-link-ic">üë•</div><div><div>JYVOS AMOUGOU</div><div class="creator-link-d">Facebook ¬∑ Suivez-nous</div></div></div>
        </div>
      </div>
    </div>
    <!-- PROFIL -->
    <div id="tab-profil" class="tab">
      <div class="pcard"><div class="pav" id="profil-av">JD</div><div class="pn" id="profil-nom">‚Äî</div><div class="pe" id="profil-email">‚Äî</div><div style="margin-top:8px;"><span class="tbadge bu" id="profil-role">G√©rant</span></div></div>
      <div class="prow">
        <div class="pr"><div><div class="pr-l">üè¢ Entreprise</div><div class="pr-d" id="profil-ent">‚Äî</div></div><span style="color:var(--muted)">‚Ä∫</span></div>
        <div class="pr"><div><div class="pr-l">üîì Statut acc√®s</div><div class="pr-d" id="profil-abo">‚Äî</div></div><span style="color:var(--muted)">‚Ä∫</span></div>
        <div class="pr"><div><div class="pr-l">üí≥ Transactions</div><div class="pr-d" id="profil-tx">0</div></div><span style="color:var(--muted)">‚Ä∫</span></div>
        <div class="pr" onclick="openAI()"><div><div class="pr-l">ü§ñ Assistant IA</div><div class="pr-d">Poser une question</div></div><span style="color:var(--purple)">‚Ä∫</span></div>
        <div class="pr" onclick="goTab('aide')"><div><div class="pr-l">üìñ Guide d'utilisation</div><div class="pr-d">Fran√ßais ¬∑ English</div></div><span style="color:var(--accent)">‚Ä∫</span></div>
      </div>
      <div class="sec-panel">
        <div style="font-size:13px;font-weight:700;margin-bottom:12px;">‚öôÔ∏è Param√®tres</div>
        <div class="sec-row"><div><div class="sec-l">Notifications rappels</div><div class="sec-d">Alertes automatiques</div></div><button class="tog on" onclick="this.classList.toggle('on')"></button></div>
        <div class="sec-row"><div><div class="sec-l">Conseils √©pargne</div><div class="sec-d">Analyse quotidienne</div></div><button class="tog on" onclick="this.classList.toggle('on')"></button></div>
      </div>
      <button class="btn-p" onclick="logout()">üö™ Se d√©connecter</button>
    </div>
  </div>
  <nav class="bnav">
    <button class="ni active" onclick="goTab('dashboard')"><div class="ni-ic">üìä</div><div class="ni-lb">Tableau</div></button>
    <button class="ni" onclick="goTab('transactions')"><div class="ni-ic">üí≥</div><div class="ni-lb">Finances</div></button>
    <button class="ni" onclick="goTab('stock')"><div class="ni-ic">üì¶</div><div class="ni-lb">Stock</div></button>
    <button class="ni" onclick="goTab('notes')" style="position:relative;"><div class="ni-ic">üìù</div><div class="ni-lb">Rappels</div><div class="notif-dot" id="note-dot"></div></button>
    <button class="ni" onclick="goTab('epargne')"><div class="ni-ic">üí°</div><div class="ni-lb">√âpargne</div></button>
    <button class="ni" onclick="goTab('calculs')"><div class="ni-ic">üßÆ</div><div class="ni-lb">Calculs</div></button>
  </nav>
  <button class="fab" onclick="openAI()">ü§ñ</button>
</div>

<!-- ADMIN -->
<div id="admin-panel" class="page">
  <div class="topbar"><div class="tb-l"><div class="tb-logo" style="background:linear-gradient(135deg,var(--gold),#8b6010);">A</div><div class="tb-name">Admin</div><span class="tbadge bd2">Super Admin</span></div><div class="tb-r"><button class="logout-btn" onclick="logout()">Quitter</button></div></div>
  <nav class="anav">
    <div class="at active" onclick="switchAdminTab(this,'at-stats')">üìä Stats</div>
    <div class="at" onclick="switchAdminTab(this,'at-demands')">üîî Demandes</div>
    <div class="at" onclick="switchAdminTab(this,'at-users')">üë• Utilisateurs</div>
    <div class="at" onclick="switchAdminTab(this,'at-pay')">üí∞ Paiements</div>
  </nav>
  <div class="content">
    <div id="at-stats" class="tab active">
      <div class="asg">
        <div class="as"><div class="as-ic">üë•</div><div class="as-lb">Utilisateurs</div><div class="as-v" id="adm-u">0</div></div>
        <div class="as"><div class="as-ic">üîî</div><div class="as-lb">Demandes</div><div class="as-v" id="adm-dem" style="color:var(--gold)">0</div></div>
        <div class="as"><div class="as-ic">‚úÖ</div><div class="as-lb">Activ√©s</div><div class="as-v" id="adm-p">0</div></div>
        <div class="as"><div class="as-ic">üí∞</div><div class="as-lb">Revenus FCFA</div><div class="as-v" id="adm-r">0</div></div>
      </div>
    </div>
    <div id="at-demands" class="tab"><div id="adm-demands-list"></div></div>
    <div id="at-users" class="tab"><div id="adm-ul"></div></div>
    <div id="at-pay" class="tab"><div id="adm-pl"></div></div>
  </div>
</div>

<!-- CHAT IA -->
<div class="ai-ov" id="ai-ov">
  <div class="ai-hd"><button class="ai-back" onclick="closeAI()">‚Üê</button><div class="ai-av">ü§ñ</div><div class="ai-hi"><div class="ai-hn">JYVOS Assistant IA</div><div class="ai-hs"><span class="ai-dot"></span>Intelligence artificielle active</div></div></div>
  <div class="ai-msgs" id="ai-msgs"></div>
  <div class="ai-chips">
    <div class="ai-chip" onclick="askAI('Analyse mes finances')">üìä Finances</div>
    <div class="ai-chip" onclick="askAI('Conseils √©pargne')">üí° √âpargne</div>
    <div class="ai-chip" onclick="askAI('G√©rer le stock')">üì¶ Stock</div>
    <div class="ai-chip" onclick="askAI('Totalisation bancaire')">üè¶ Banque</div>
    <div class="ai-chip" onclick="askAI('Infos paiement')">üí∞ Paiement</div>
    <div class="ai-chip" onclick="askAI('Tableau de calcul')">üßÆ Calculs</div>
  </div>
  <div class="ai-inp"><input class="ai-cinp" id="ai-input" placeholder="Posez votre question..." onkeydown="if(event.key==='Enter')sendAI()"><button class="ai-snd" onclick="sendAI()">‚û§</button></div>
</div>

<!-- MODALS -->
<div class="mb" id="tx-modal"><div class="mod"><div class="mod-t">Nouvelle Transaction <button class="mod-x" onclick="closeModal('tx-modal')">√ó</button></div><div class="fi"><label>Type</label><select id="tx-type"><option value="in">üìà Entr√©e d'argent</option><option value="out">üìâ Sortie d'argent</option></select></div><div class="fi"><label>Description</label><input type="text" id="tx-desc" placeholder="Ex: Vente marchandise"></div><div class="fi"><label>Montant (FCFA)</label><input type="number" id="tx-amount" placeholder="0"></div><div class="fi"><label>Cat√©gorie</label><select id="tx-cat"><option>Ventes</option><option>Achats</option><option>Salaires</option><option>Loyer</option><option>Transport</option><option>Autre</option></select></div><button class="btn-p" onclick="addTransaction()">Enregistrer ‚Üí</button></div></div>
<div class="mb" id="stock-modal"><div class="mod"><div class="mod-t">Nouveau Produit <button class="mod-x" onclick="closeModal('stock-modal')">√ó</button></div><div class="fi"><label>Nom</label><input type="text" id="st-nom" placeholder="Ex: Riz 50kg"></div><div class="fi"><label>Quantit√©</label><input type="number" id="st-qty" placeholder="0"></div><div class="fi"><label>Seuil minimum</label><input type="number" id="st-min" placeholder="5"></div><div class="fi"><label>Prix unitaire (FCFA)</label><input type="number" id="st-prix" placeholder="0"></div><button class="btn-p" onclick="addStock()">Ajouter ‚Üí</button></div></div>
<div class="mb" id="note-modal"><div class="mod"><div class="mod-t">Nouveau Rappel <button class="mod-x" onclick="closeModal('note-modal')">√ó</button></div><div class="fi"><label>Type</label><select id="note-type" onchange="toggleDF()"><option value="rappel">‚è∞ Rappel avec alarme</option><option value="note">üìù Note simple</option></select></div><div class="fi"><label>Titre</label><input type="text" id="note-titre" placeholder="Ex: Payer le fournisseur"></div><div class="fi"><label>Description</label><textarea id="note-body" placeholder="D√©tails..."></textarea></div><div class="fi" id="note-df"><label>üìÖ Date et heure</label><input type="datetime-local" id="note-date"></div><div class="fi"><label>Priorit√©</label><select id="note-prio"><option value="normal">Normal</option><option value="urgent">üî¥ Urgent</option></select></div><button class="btn-p" onclick="addNote()">Enregistrer ‚Üí</button></div></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
const TDAYS=7;
// DB global : utilisateurs, demandes, admin uniquement
let DB={users:[],demands:[],currentUser:null};
// Donn√©es priv√©es par utilisateur (transactions, stock, notes)
let UD={transactions:[],stock:[],notes:[]};

function saveDB(){try{localStorage.setItem('jyvos6_global',JSON.stringify(DB));}catch(e){}}
function loadDB(){try{const d=localStorage.getItem('jyvos6_global');if(d)DB=JSON.parse(d);}catch(e){}}

// Sauvegarder les donn√©es de l'utilisateur courant
function saveUD(){
  if(!DB.currentUser)return;
  try{localStorage.setItem('jyvos6_user_'+DB.currentUser.id,JSON.stringify(UD));}catch(e){}
}
// Charger les donn√©es de l'utilisateur courant
function loadUD(){
  UD={transactions:[],stock:[],notes:[]};
  if(!DB.currentUser)return;
  try{
    const d=localStorage.getItem('jyvos6_user_'+DB.currentUser.id);
    if(d)UD=JSON.parse(d);
  }catch(e){}
}
loadDB();
function showPage(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');}
function goTab(n){
  document.querySelectorAll('#app .tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.ni').forEach(x=>x.classList.remove('active'));
  const el=document.getElementById('tab-'+n);if(el)el.classList.add('active');
  const nav=['dashboard','transactions','stock','notes','epargne','calculs'];
  const i=nav.indexOf(n);if(i>=0)document.querySelectorAll('.ni')[i].classList.add('active');
  if(n==='dashboard')refreshDash();
  if(n==='transactions')renderTx();
  if(n==='stock')renderStock();
  if(n==='notes')renderNotes();
  if(n==='epargne')renderEpargne();
  if(n==='calculs')initCalc();
  if(n==='profil')renderProfil();
}
function switchAdminTab(el,id){
  document.querySelectorAll('.at').forEach(a=>a.classList.remove('active'));
  document.querySelectorAll('#admin-panel .tab').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');document.getElementById(id).classList.add('active');
  if(id==='at-demands')renderDemands();
  if(id==='at-users')renderAdminUsers();
  if(id==='at-pay')renderAdminPay();
  if(id==='at-stats')renderAdminStats();
}
function openModal(id){document.getElementById(id).classList.add('open');}
function closeModal(id){document.getElementById(id).classList.remove('open');}
function toggleDF(){document.getElementById('note-df').style.display=document.getElementById('note-type').value==='rappel'?'block':'none';}
function setLang(l){
  document.getElementById('guide-fr').style.display=l==='fr'?'block':'none';
  document.getElementById('guide-en').style.display=l==='en'?'block':'none';
  document.getElementById('lang-fr').className='lang-btn'+(l==='fr'?' active':'');
  document.getElementById('lang-en').className='lang-btn'+(l==='en'?' active':'');
}
function trialStatus(u){
  if(u.paid)return{ok:true,days:0};
  const d=Math.floor((Date.now()-u.joinDate)/(86400000));
  const r=TDAYS-d;
  if(r>0)return{ok:true,days:r,trial:true};
  return{ok:false};
}
function register(){
  const nom=g('reg-nom'),email=g('reg-email'),ent=g('reg-ent'),role=g('reg-role'),pw='JYVOS-'+g('reg-pw');
  const al=document.getElementById('reg-alert');
  if(!nom||!email||!ent||pw==='JYVOS-'){showAlert(al,'Remplissez tous les champs.','e');return;}
  if(DB.users.find(u=>u.email===email)){showAlert(al,'Email d√©j√† utilis√©.','e');return;}
  const u={id:Date.now(),nom,email,ent,role,pw,paid:false,joinDate:Date.now(),demandSent:false};
  DB.users.push(u);DB.currentUser=u;saveDB();loadUD();
  showAlert(al,'Compte cr√©√© ! Essai de 7 jours commenc√© üéâ','ok');
  setTimeout(()=>enterApp(u),1000);
}
function login(){
  const email=g('login-email'),pw='JYVOS-'+g('login-pw');
  const al=document.getElementById('login-alert');
  const u=DB.users.find(u=>u.email===email&&u.pw===pw);
  if(!u){showAlert(al,'Email ou mot de passe incorrect.','e');return;}
  DB.currentUser=u;saveDB();loadUD();
  const ts=trialStatus(u);
  if(!ts.ok){showPage('blocked-page');checkPending();return;}
  enterApp(u);
}

function adminLogin(){
  if(g('adm-pw')==='JYVOS@Admin2024'){showPage('admin-panel');renderAdminStats();}
  else showAlert(document.getElementById('adm-alert'),'Code incorrect.','e');
}
function logout(){DB.currentUser=null;UD={transactions:[],stock:[],notes:[]};saveDB();showPage('landing');closeAI();}
function enterApp(u){
  loadUD();
  showPage('app');
  const ini=initials(u.nom);
  s('user-av',ini);s('dash-av',ini);
  s('role-badge',roleLabel(u.role));
  s('dash-welcome','Bonjour, '+u.nom.split(' ')[0]+' üëã');
  s('dash-date',new Date().toLocaleDateString('fr-FR',{weekday:'long',day:'numeric',month:'long'}));
  const ts=trialStatus(u);
  const tw=document.getElementById('trial-warn');
  if(ts.trial){tw.style.display='flex';s('trial-days',ts.days);}else{tw.style.display='none';}
  goTab('dashboard');
  checkRappels();setInterval(checkRappels,60000);
}
function sendDemand(){
  const u=DB.currentUser;if(!u)return;
  const real=DB.users.find(x=>x.id===u.id);
  if(real&&real.demandSent){document.getElementById('pending-box').style.display='block';document.getElementById('demand-btn').style.display='none';return;}
  if(real)real.demandSent=true;
  if(!DB.demands)DB.demands=[];
  DB.demands.push({id:Date.now(),userId:u.id,nom:u.nom,email:u.email,ent:u.ent,date:today(),status:'pending'});
  saveDB();
  document.getElementById('pending-box').style.display='block';
  document.getElementById('demand-btn').style.display='none';
}
function checkPending(){
  const u=DB.currentUser;if(!u)return;
  const real=DB.users.find(x=>x.id===u.id);
  if(real&&real.demandSent){document.getElementById('pending-box').style.display='block';document.getElementById('demand-btn').style.display='none';}
}
function approveDemand(id){
  const d=DB.demands.find(x=>x.id===id);if(!d)return;
  d.status='approved';
  const u=DB.users.find(u=>u.id===d.userId);if(u)u.paid=true;
  saveDB();renderDemands();renderAdminStats();toast('‚úÖ Acc√®s activ√© pour '+d.nom);
}
function rejectDemand(id){
  const d=DB.demands.find(x=>x.id===id);if(!d)return;
  d.status='rejected';saveDB();renderDemands();toast('Demande rejet√©e','e');
}
function renderDemands(){
  if(!DB.demands)DB.demands=[];
  const list=document.getElementById('adm-demands-list');
  if(!DB.demands.length){list.innerHTML='<div class="empty"><div class="empty-ic">üîî</div>Aucune demande</div>';return;}
  const pend=DB.demands.filter(d=>d.status==='pending');
  const done=DB.demands.filter(d=>d.status!=='pending');
  list.innerHTML=
    (pend.length?'<div style="font-size:12px;font-weight:700;color:var(--gold);margin-bottom:10px;">‚è≥ En attente ('+pend.length+')</div>':'')+
    pend.map(d=>`<div class="demand-item"><div class="demand-top"><div class="demand-av">${initials(d.nom)}</div><div><div class="demand-n">${d.nom}</div><div class="demand-d">${d.email} ¬∑ ${d.ent} ¬∑ ${d.date}</div></div></div><div class="demand-btns"><button class="dbtn approve" onclick="approveDemand(${d.id})">‚úÖ Activer</button><button class="dbtn reject" onclick="rejectDemand(${d.id})">‚ùå Rejeter</button></div></div>`).join('')+
    (done.length?'<div style="font-size:12px;font-weight:700;color:var(--muted);margin:14px 0 10px;">Historique</div>':'')+
    done.map(d=>`<div class="txi" style="opacity:.6;"><div class="txic ${d.status==='approved'?'in':'out'}">${d.status==='approved'?'‚úÖ':'‚ùå'}</div><div class="txd"><div class="txn">${d.nom}</div><div class="txdt">${d.email}</div></div><span style="font-size:11px;color:var(--muted)">${d.status==='approved'?'Activ√©':'Rejet√©'}</span></div>`).join('');
}
let bankPeriod='jour';
function switchBankTab(el,p){document.querySelectorAll('.btab').forEach(b=>b.classList.remove('active'));el.classList.add('active');bankPeriod=p;renderBank(p);}
function getFilter(p){
  const now=new Date();
  if(p==='jour'){const s=new Date(now.getFullYear(),now.getMonth(),now.getDate()).getTime();return t=>t>=s;}
  if(p==='semaine'){const d=now.getDay(),s=new Date(now.getFullYear(),now.getMonth(),now.getDate()-d).getTime();return t=>t>=s;}
  if(p==='mois'){const s=new Date(now.getFullYear(),now.getMonth(),1).getTime();return t=>t>=s;}
  return()=>true;
}
function renderBank(p){
  const u=DB.currentUser;
  const filter=getFilter(p);
  let src=UD.transactions.filter(t=>t.ts&&filter(t.ts));
  let inc=0,out=0;src.forEach(t=>{if(t.type==='in')inc+=t.amount;else out+=t.amount;});
  const net=inc-out;
  const lbl={jour:"aujourd'hui",semaine:'cette semaine',mois:'ce mois'};
  document.getElementById('bank-rows').innerHTML=
    `<div class="bank-row"><div class="bank-row-l">üìà Entr√©es ${lbl[p]}</div><div class="bank-row-v" style="color:var(--green)">${fmt(inc)}</div></div>`+
    `<div class="bank-row"><div class="bank-row-l">üìâ Sorties ${lbl[p]}</div><div class="bank-row-v" style="color:var(--red)">${fmt(out)}</div></div>`+
    `<div class="bank-total-row"><div class="bank-total-l">üíú Solde net</div><div class="bank-total-v" style="color:${net>=0?'var(--green)':'var(--red)'}">${net>=0?'+':''}${fmt(net)}</div></div>`;
}
function refreshDash(){
  const u=DB.currentUser;if(!u)return;
  let rev=0,dep=0;
  UD.transactions.forEach(t=>{if(t.type==='in')rev+=t.amount;else dep+=t.amount;});
  s('capital-val',fmt(rev-dep));s('rev-val',fmt(rev));s('dep-val',fmt(dep));
  s('tx-count',UD.transactions.length);s('stock-count',UD.stock.length);
  s('alert-count',UD.stock.filter(x=>x.qty<=x.min).length);
  const an=UD.notes.filter(n=>!n.done).length;
  s('notes-count',an);
  document.getElementById('note-dot').style.display=an>0?'block':'none';
  renderBank(bankPeriod);
  const last=UD.transactions.slice(-3).reverse();
  document.getElementById('dash-tx').innerHTML=last.length?last.map(txHtml).join(''):'<div class="empty"><div class="empty-ic">üí≥</div>Aucune transaction</div>';
}
function addTransaction(){
  const type=g('tx-type'),desc=g('tx-desc'),amount=parseFloat(g('tx-amount'))||0,cat=g('tx-cat');
  if(!desc||!amount){toast('Remplissez tous les champs','e');return;}
  UD.transactions.push({id:Date.now(),type,desc,amount,cat,date:today(),ts:Date.now()});
  saveUD();closeModal('tx-modal');
  document.getElementById('tx-desc').value='';document.getElementById('tx-amount').value='';
  renderTx();toast('Transaction enregistr√©e ‚úÖ');
}
function renderTx(){
  const txs=UD.transactions.slice().reverse();
  document.getElementById('tx-list').innerHTML=txs.length?txs.map(txHtml).join(''):'<div class="empty"><div class="empty-ic">üí≥</div>Aucune transaction</div>';
}
function txHtml(t){return `<div class="txi"><div class="txic ${t.type}">${t.type==='in'?'üìà':'üìâ'}</div><div class="txd"><div class="txn">${t.desc}</div><div class="txdt">${t.cat} ¬∑ ${t.date}</div></div><div class="txa ${t.type}">${t.type==='in'?'+':'-'}${fmt(t.amount)}</div></div>`;}
function addStock(){
  const nom=g('st-nom'),qty=parseInt(g('st-qty'))||0,min=parseInt(g('st-min'))||5,prix=parseFloat(g('st-prix'))||0;
  if(!nom){toast('Entrez un nom','e');return;}
  UD.stock.push({id:Date.now(),nom,qty,min,prix});saveUD();closeModal('stock-modal');
  document.getElementById('st-nom').value='';document.getElementById('st-qty').value='';
  renderStock();toast('Produit ajout√© ‚úÖ');
}
function renderStock(){
  const list=document.getElementById('stock-list');
  if(!UD.stock.length){list.innerHTML='<div class="empty"><div class="empty-ic">üì¶</div>Aucun produit</div>';return;}
  list.innerHTML=UD.stock.map(x=>{const low=x.qty<=x.min;return `<div class="stock-item"><div class="stock-ic">üì¶</div><div class="stock-d"><div class="stock-n">${x.nom}</div><div class="stock-c">${fmt(x.prix)} ¬∑ Min: ${x.min}</div></div><div style="text-align:right"><div class="stock-qty ${low?'low':'ok'}">${x.qty}</div><div class="stock-alert ${low?'low':'ok'}">${low?'‚ö†Ô∏è Bas':'‚úÖ OK'}</div></div></div>`;}).join('');
}
function addNote(){
  const type=g('note-type'),titre=g('note-titre'),body=g('note-body'),date=g('note-date'),prio=g('note-prio');
  if(!titre){toast('Entrez un titre','e');return;}
  UD.notes.push({id:Date.now(),type,titre,body,date,prio,done:false});
  saveUD();closeModal('note-modal');
  document.getElementById('note-titre').value='';document.getElementById('note-body').value='';
  renderNotes();refreshDash();toast('Rappel cr√©√© ‚úÖ');
  if(type==='rappel'&&date){const ms=new Date(date).getTime()-Date.now();if(ms>0&&ms<2592000000)setTimeout(()=>toast('‚è∞ RAPPEL : '+titre,'rappel'),ms);}
}
function renderNotes(){
  const notes=UD.notes.slice().reverse();
  document.getElementById('notes-list').innerHTML=notes.length?notes.map(n=>`<div class="note-item ${n.prio==='urgent'?'urgent':''} ${n.done?'done':''}"><div class="note-top"><div class="note-ic ${n.type}">${n.type==='rappel'?'‚è∞':'üìù'}</div><div style="flex:1"><div class="note-ti">${n.titre}${n.prio==='urgent'?' üî¥':''}</div><div class="note-bd">${n.body||''}</div></div></div><div class="note-foot"><div>${n.date?`<span class="alarm-badge">‚è∞ ${new Date(n.date).toLocaleString('fr-FR',{day:'2-digit',month:'2-digit',hour:'2-digit',minute:'2-digit'})}</span>`:'<span style="font-size:11px;color:var(--muted)">Note permanente</span>'}</div><div class="note-btns">${!n.done?`<button class="nbtn ok" onclick="doneNote(${n.id})">‚úÖ Fait</button>`:'<span style="font-size:11px;color:var(--green)">‚úÖ Termin√©</span>'}<button class="nbtn del" onclick="delNote(${n.id})">üóëÔ∏è</button></div></div></div>`).join(''):'<div class="empty"><div class="empty-ic">üìù</div>Aucun rappel</div>';
}
function doneNote(id){const n=UD.notes.find(x=>x.id===id);if(n)n.done=true;saveUD();renderNotes();refreshDash();}
function delNote(id){UD.notes=UD.notes.filter(x=>x.id!==id);saveUD();renderNotes();refreshDash();}
function checkRappels(){const now=Date.now();UD.notes.filter(n=>n.type==='rappel'&&!n.done&&n.date).forEach(n=>{const t=new Date(n.date).getTime();if(t<=now&&t>now-120000)toast('‚è∞ RAPPEL : '+n.titre,'rappel');});}
function renderEpargne(){
  let rev=0,dep=0;
  const u=DB.currentUser;
  UD.transactions.forEach(t=>{if(t.type==='in')rev+=t.amount;else dep+=t.amount;});
  let score=0,msg='',conseils=[];
  if(rev===0){score=0;msg='Ajoutez vos transactions pour vos conseils üí°';conseils=[{ic:'üí°',t:'Commencez le suivi',d:'Enregistrez revenus et d√©penses dans Finances.',tag:'ti'}];}
  else{
    const ratio=dep/rev,ep=rev-dep;
    score=Math.max(0,Math.min(100,Math.round((1-ratio)*100)));
    if(score>=80)msg='üèÜ Excellent ! Finances exemplaires.';
    else if(score>=60)msg='üëç Bien ! Quelques optimisations possibles.';
    else if(score>=40)msg='‚ö†Ô∏è Attention : d√©penses √©lev√©es.';
    else msg='üö® Critique : d√©penses > revenus !';
    if(ratio>0.8)conseils.push({ic:'üö®',t:'R√©duire les d√©penses',d:`D√©penses = ${Math.round(ratio*100)}% des revenus. √âliminez le non-essentiel.`,tag:'tc'});
    if(ep>0)conseils.push({ic:'üè¶',t:`√âpargnez ${fmt(Math.round(ep*0.2))}`,d:'Mettez 20% de votre b√©n√©fice de c√¥t√© chaque mois.',tag:score>=60?'tok':'ti'});
    conseils.push({ic:'üìä',t:'Diversifiez vos revenus',d:'Ne d√©pendez pas d\'une seule source de revenus.',tag:'ti'});
    if(UD.stock.some(x=>x.qty<=x.min))conseils.push({ic:'üì¶',t:'R√©approvisionnez le stock',d:'Des produits en rupture = ventes perdues.',tag:'tc'});
    conseils.push({ic:'üí≥',t:'Acceptez le Mobile Money',d:'Orange Money, MTN MoMo augmentent les ventes de 20 √† 40%.',tag:'tok'});
    if(ratio<0.5&&ep>0)conseils.push({ic:'üöÄ',t:'Investissez vos exc√©dents',d:`R√©investissez ${fmt(Math.round(ep*0.3))} dans votre activit√©.`,tag:'tok'});
  }
  document.getElementById('ep-score').textContent=score+'/100';
  document.getElementById('ep-fill').style.width=score+'%';
  document.getElementById('ep-msg').textContent=msg;
  document.getElementById('conseils-list').innerHTML=conseils.map(c=>`<div class="conseil-item"><div class="conseil-ic">${c.ic}</div><div><div class="conseil-t">${c.t}</div><div class="conseil-d">${c.d}</div><span class="conseil-tag ${c.tag}">${c.tag==='tc'?'‚ö†Ô∏è Critique':c.tag==='ti'?'üí° Important':'‚úÖ Bon signe'}</span></div></div>`).join('');
}
// CALCULS EXCEL
let cCols=['D√©signation','Qt√©','Prix Unit.','Montant'];
let cRows=[['Produit 1','10','5000','50000'],['Produit 2','5','12000','60000'],['Produit 3','20','2500','50000'],['','','','']];
let calcDone=false;
function initCalc(){if(!calcDone){calcDone=false;}renderCalc();updateTVA();}
function renderCalc(){
  const t=document.getElementById('calc-table');
  let h='<thead><tr><th style="width:28px;">#</th>';
  cCols.forEach((c,i)=>h+=`<th><input value="${c}" onchange="cCols[${i}]=this.value;updateTVA()" style="background:transparent;border:none;color:var(--accent);font-weight:700;font-size:10px;font-family:inherit;width:70px;text-align:center;outline:none;"></th>`);
  h+='</tr></thead><tbody>';
  cRows.forEach((row,ri)=>{
    h+=`<tr>`;
    h+=`<td style="text-align:center;padding:6px 4px;font-size:10px;color:var(--muted2)">${ri+1}</td>`;
    row.forEach((cell,ci)=>{
      const isLabel=ci===0;
      h+=`<td class="${isLabel?'rl':''}"><input type="${isLabel?'text':'number'}" value="${cell}" oninput="cRows[${ri}][${ci}]=this.value;autoRow(${ri});updateTVA()" placeholder="-"></td>`;
    });
    h+='</tr>';
  });
  // Total row
  h+='<tr class="tr"><td style="text-align:center;font-size:11px;color:var(--purple);padding:6px 4px;">‚àë</td>';
  cCols.forEach((c,ci)=>{
    if(ci===0){h+=`<td class="rl"><input value="TOTAUX" readonly></td>`;}
    else{
      const tot=cRows.reduce((s,r)=>s+(parseFloat(r[ci])||0),0);
      h+=`<td><input value="${tot.toLocaleString('fr-FR')}" readonly></td>`;
    }
  });
  h+='</tr></tbody>';
  t.innerHTML=h;
}
function autoRow(ri){
  if(cCols.length>=4){
    const qty=parseFloat(cRows[ri][1])||0;
    const prix=parseFloat(cRows[ri][2])||0;
    if(qty>0&&prix>0){cRows[ri][3]=(qty*prix).toString();renderCalc();}
  }
}
function updateTVA(){
  const lastCol=cRows.reduce((s,r)=>s+(parseFloat(r[cCols.length-1])||0),0);
  const ht=lastCol;
  const tva=ht*0.1925;
  const ttc=ht+tva;
  document.getElementById('tva-ht').textContent=fmt(ht);
  document.getElementById('tva-val').textContent=fmt(tva);
  document.getElementById('tva-ttc').textContent=fmt(ttc);
  const totalQty=cRows.reduce((s,r)=>s+(parseFloat(r[1])||0),0);
  const totalPrix=cRows.reduce((s,r)=>s+(parseFloat(r[2])||0),0);
  document.getElementById('tva-marge').textContent=totalPrix>0?fmt(ht-totalPrix)+' ('+Math.round((ht-totalPrix)/ht*100||0)+'%)':'‚Äî';
  const grid=document.getElementById('calc-grid');
  const colors=['var(--accent)','var(--gold)','var(--green)'];
  grid.innerHTML=cCols.slice(1).map((c,i)=>{
    const tot=cRows.reduce((s,r)=>s+(parseFloat(r[i+1])||0),0);
    return `<div class="calc-card"><div class="calc-card-ic">üìä</div><div class="calc-card-lb">${c}</div><div class="calc-card-v" style="color:${colors[i]||'var(--muted)'}">${tot.toLocaleString('fr-FR')}</div></div>`;
  }).join('');
}
function addCalcRow(){cRows.push(new Array(cCols.length).fill(''));renderCalc();updateTVA();}
function addCalcCol(){cCols.push('Col '+(cCols.length));cRows.forEach(r=>r.push(''));renderCalc();updateTVA();}
function delLastRow(){if(cRows.length>1){cRows.pop();renderCalc();updateTVA();}}
function clearCalc(){cCols=['D√©signation','Qt√©','Prix Unit.','Montant'];cRows=[['','','',''],['','','',''],['','','','']];renderCalc();updateTVA();}
function renderProfil(){
  const u=DB.currentUser;if(!u)return;
  s('profil-av',initials(u.nom));s('profil-nom',u.nom);s('profil-email',u.email||'‚Äî');
  s('profil-ent',u.ent||'‚Äî');s('profil-role',roleLabel(u.role));
  const ts=trialStatus(u);
  s('profil-abo',u.paid?'‚úÖ Acc√®s √† vie activ√©':ts.trial?`üéÅ Essai ¬∑ ${ts.days} jours restants`:'‚è≥ En attente activation');
  s('profil-tx',UD.transactions.length+' transactions');
}
function renderAdminStats(){
  if(!DB.demands)DB.demands=[];
  s('adm-u',DB.users.length);s('adm-p',DB.users.filter(u=>u.paid).length);
  s('adm-dem',DB.demands.filter(d=>d.status==='pending').length);
  s('adm-r',(DB.users.filter(u=>u.paid).length*500).toLocaleString('fr-FR')+' FCFA');
}
function renderAdminUsers(){
  const list=document.getElementById('adm-ul');
  if(!DB.users.length){list.innerHTML='<div class="empty">Aucun utilisateur</div>';return;}
  list.innerHTML=DB.users.map(u=>{
    const ts=trialStatus(u);
    const status=u.paid?'‚úÖ Activ√©':ts.trial?`üéÅ Essai (${ts.days}j)`:'üîí Expir√©';
    const col=u.paid?'var(--green)':ts.trial?'var(--accent)':'var(--red)';
    return `<div class="txi"><div class="txic in">${initials(u.nom)}</div><div class="txd"><div class="txn">${u.nom}</div><div class="txdt">${u.email} ¬∑ ${roleLabel(u.role)}</div></div><div style="text-align:right;flex-shrink:0"><span style="font-size:10px;padding:2px 7px;border-radius:20px;background:rgba(255,255,255,.05);color:${col};">${status}</span><br>${!u.paid?`<button onclick="activateUser(${u.id})" style="margin-top:4px;padding:3px 8px;border-radius:7px;background:var(--green-dim);color:var(--green);border:1px solid rgba(0,200,150,.2);font-size:10px;font-weight:700;cursor:pointer;font-family:inherit;">‚úÖ Activer</button>`:`<button onclick="deactivateUser(${u.id})" style="margin-top:4px;padding:3px 8px;border-radius:7px;background:var(--red-dim);color:var(--red);border:1px solid rgba(255,77,109,.2);font-size:10px;font-weight:700;cursor:pointer;font-family:inherit;">üîí Bloquer</button>`}</div></div>`;
  }).join('');
}
function activateUser(id){const u=DB.users.find(u=>u.id===id);if(u){u.paid=true;saveDB();renderAdminUsers();renderAdminStats();toast('‚úÖ Utilisateur activ√©');}}
function deactivateUser(id){const u=DB.users.find(u=>u.id===id);if(u){u.paid=false;saveDB();renderAdminUsers();renderAdminStats();toast('Utilisateur bloqu√©','e');}}
function renderAdminPay(){
  const paid=DB.users.filter(u=>u.paid);
  document.getElementById('adm-pl').innerHTML=paid.length?paid.map(u=>`<div class="txi"><div class="txic in">‚úÖ</div><div class="txd"><div class="txn">${u.nom}</div><div class="txdt">${u.email}</div></div><div class="txa in">500 FCFA</div></div>`).join(''):'<div class="empty">Aucun paiement confirm√©</div>';
}
// CHAT IA
const KB={
  bonjour:['üëã Bonjour ! Je suis **JYVOS IA**.\n\nJe peux vous aider avec :\n‚Ä¢ üìä Finances ¬∑ üí° √âpargne\n‚Ä¢ üì¶ Stock ¬∑ üè¶ Banque\n‚Ä¢ üßÆ Calculs ¬∑ üìù Rappels\n‚Ä¢ üí∞ Paiement\n\nQue puis-je faire pour vous ? üòä'],
  transaction:['üí≥ Enregistrer une transaction :\n1. Onglet **Finances** ‚Üí **+ Ajouter**\n2. Choisissez üìà Entr√©e ou üìâ Sortie\n3. Description, montant, cat√©gorie\n4. **Enregistrer** ‚úÖ'],
  stock:['üì¶ G√©rer le stock :\n1. Onglet **Stock** ‚Üí **+ Produit**\n2. Nom, quantit√©, prix, seuil minimum\n\nAlerte automatique quand stock bas ! ‚ö†Ô∏è'],
  epargne:['üí° Conseils √©pargne :\n\n‚Ä¢ √âpargnez **20%** de vos b√©n√©fices\n‚Ä¢ Constituez **3 mois** de r√©serve\n‚Ä¢ R√©duisez les d√©penses non essentielles\n\nVoir onglet **√âpargne** pour votre score personnalis√© !'],
  rappel:['üìù Cr√©er un rappel :\n1. Onglet **Rappels** ‚Üí **+ Ajouter**\n2. Choisissez "Rappel avec alarme"\n3. Titre, description, date/heure\n\nAlerte automatique ! ‚è∞'],
  paiement:['üí∞ Paiement JYVOS :\n\nüéÅ **7 jours gratuits** √† l\'inscription\n‚úÖ Ensuite **500 FCFA unique** ¬∑ Acc√®s √† vie\n\nüì± Orange Money ‚Üí **691 928 061**\nNom : NGAH NTSAMA\n\nApr√®s paiement ‚Üí cliquez "J\'ai pay√© ¬∑ Demander l\'acc√®s"'],
  banque:['üè¶ Totalisation bancaire :\n\nTableau de bord ‚Üí section üè¶ :\n‚Ä¢ üìÖ Totaux du **jour**\n‚Ä¢ üìÜ Totaux de la **semaine**\n‚Ä¢ üóìÔ∏è Totaux du **mois**\n\nSolde net = Entr√©es - Sorties\nId√©al pour la **cl√¥ture journali√®re** !'],
  calcul:['üßÆ Tableau de calcul Excel :\n\n1. Onglet **Calculs** en bas\n2. Remplissez Qt√© et Prix ‚Üí Montant calcul√© auto\n3. Boutons + Ligne / + Colonne\n4. **TVA 19.25%** et **Total TTC** automatiques\n5. **Marge brute** calcul√©e\n\nComme Excel mais sur mobile ! üì±'],
  default:['Je suis l√† pour vous aider !\n‚Ä¢ üìä Finances ¬∑ üí° √âpargne ¬∑ üì¶ Stock\n‚Ä¢ üè¶ Banque ¬∑ üßÆ Calculs ¬∑ üí∞ Paiement']
};
function getReply(msg){
  const m=msg.toLowerCase();
  if(m.includes('bonjour')||m.includes('salut')||m.includes('bonsoir')||m.includes('hello'))return rnd(KB.bonjour);
  if(m.includes('calcul')||m.includes('excel')||m.includes('tableau')||m.includes('tva'))return rnd(KB.calcul);
  if(m.includes('transaction')||m.includes('enregistr'))return rnd(KB.transaction);
  if(m.includes('stock')||m.includes('produit'))return rnd(KB.stock);
  if(m.includes('rappel')||m.includes('note')||m.includes('alarme'))return rnd(KB.rappel);
  if(m.includes('paiement')||m.includes('500')||m.includes('orange')||m.includes('essai'))return rnd(KB.paiement);
  if(m.includes('√©pargn')||m.includes('economi')||m.includes('conseil'))return rnd(KB.epargne);
  if(m.includes('banqu')||m.includes('total')||m.includes('cl√¥tur'))return rnd(KB.banque);
  let rev=0,dep=0;const u=DB.currentUser;
  UD.transactions.forEach(t=>{if(t.type==='in')rev+=t.amount;else dep+=t.amount;});
  if(m.includes('finance')||m.includes('capital')||m.includes('argent')||m.includes('analys')){
    if(rev===0)return 'üìä Pas encore de transactions. Onglet **Finances** ‚Üí **+ Ajouter** !';
    const ep=rev-dep,ratio=dep/rev;
    return `üìä **Votre situation :**\n\nüí∞ Revenus : ${fmt(rev)}\nüìâ D√©penses : ${fmt(dep)}\nüíö Capital : ${fmt(ep)}\nüìà Score : ${Math.round((1-ratio)*100)}/100\n\n${ep>0?`‚úÖ B√©n√©ficiaire ! √âpargnez ${fmt(Math.round(ep*0.2))} (20%).`:'üö® D√©penses > Revenus. R√©duisez les charges.'}`;
  }
  return rnd(KB.default);
}
let aiOpen=false;
function openAI(){aiOpen=true;document.getElementById('ai-ov').classList.add('open');const m=document.getElementById('ai-msgs');if(!m.children.length)addMsg('b',rnd(KB.bonjour));}
function closeAI(){aiOpen=false;document.getElementById('ai-ov').classList.remove('open');}
function sendAI(){const inp=document.getElementById('ai-input');const msg=inp.value.trim();if(!msg)return;inp.value='';askAI(msg);}
function askAI(msg){
  if(!aiOpen)openAI();
  addMsg('u',msg);
  const tp=document.createElement('div');tp.className='tping';tp.id='tp';
  tp.innerHTML='<div class="tdot"></div><div class="tdot"></div><div class="tdot"></div>';
  document.getElementById('ai-msgs').appendChild(tp);scrollAI();
  setTimeout(()=>{const t=document.getElementById('tp');if(t)t.remove();addMsg('b',getReply(msg));},800);
}
function addMsg(role,text){
  const m=document.getElementById('ai-msgs');
  const d=document.createElement('div');d.className='bbl '+role;
  d.innerHTML=text.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>')+`<div class="bt">${role==='b'?'ü§ñ JYVOS IA':'Vous'} ¬∑ ${new Date().toLocaleTimeString('fr',{hour:'2-digit',minute:'2-digit'})}</div>`;
  m.appendChild(d);scrollAI();
}
function scrollAI(){const m=document.getElementById('ai-msgs');m.scrollTop=m.scrollHeight;}
function g(id){return(document.getElementById(id)||{}).value||'';}
function s(id,val){const el=document.getElementById(id);if(el)el.textContent=val;}
function fmt(n){return Number(n).toLocaleString('fr-FR')+' FCFA';}
function today(){return new Date().toLocaleDateString('fr');}
function initials(nom){return(nom||'?').split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();}
function roleLabel(r){return r==='gerant'?'G√©rant':r==='comptable'?'Comptable':'Employ√©';}
function rnd(arr){return arr[Math.floor(Math.random()*arr.length)];}
function showAlert(el,msg,type){el.textContent=msg;el.className='al show al-'+(type==='e'?'e':'ok');}
function toast(msg,type){
  const d=document.createElement('div');
  d.style.cssText='position:fixed;top:65px;right:14px;z-index:999;padding:9px 14px;border-radius:20px;font-size:12px;font-weight:700;box-shadow:0 4px 20px rgba(0,0,0,.3);animation:pop .2s ease;max-width:260px;line-height:1.4;';
  d.style.background=type==='rappel'?'var(--gold)':type==='e'?'var(--red)':'var(--green)';
  d.style.color='#fff';d.textContent=msg;document.body.appendChild(d);setTimeout(()=>d.remove(),3500);
}
document.querySelectorAll('.mb').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('open');}));
if(DB.currentUser){
  const u=DB.currentUser;
  loadUD();
  const ts=trialStatus(u);
  if(!ts.ok&&!u.paid){showPage('blocked-page');checkPending();}
  else{enterApp(u);}
}
</script>
</body>
</html>
